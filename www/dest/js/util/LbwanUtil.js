!function(a){"use strict";function b(a){function b(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d<a.length;++d)c[d]=a[d];return b}var c=null;"function"==typeof require;var d=function(a,b){a="undefined"!=typeof a?parseInt(a,10):d.DEFAULT_CAPACITY,1>a&&(a=d.DEFAULT_CAPACITY),this.array=3==arguments.length&&arguments[2]===!0?null:new ArrayBuffer(a),this.view=null!=this.array?new DataView(this.array):null,this.offset=0,this.markedOffset=-1,this.length=0,this.littleEndian="undefined"!=typeof b?!!b:!1};d.DEFAULT_CAPACITY=16,d.LITTLE_ENDIAN=!0,d.BIG_ENDIAN=!1,d.Long=a,d.allocate=function(a,b){return new d(a,b)},d.wrap=function(a,e){if("string"==typeof a)return(new d).writeUTF8String(a).flip();var f;if(c&&c.isBuffer(a)&&(f=new Uint8Array(a).buffer,a=f===a?b(a):f),a.array?a=a.array:a.buffer&&(a=a.buffer),!(a instanceof ArrayBuffer))throw new Error("Cannot wrap buffer of type "+typeof a+", "+a.constructor.name);return f=new d(0,e,!0),f.array=a,f.view=new DataView(f.array),f.offset=0,f.length=a.byteLength,f},d.prototype.LE=function(){return this.littleEndian=!0,this},d.prototype.BE=function(){return this.littleEndian=!1,this},d.prototype.resize=function(a){if(1>a)return!1;if(null==this.array&&(this.array=new ArrayBuffer(a),this.view=new DataView(this.array)),this.array.byteLength<a){var b=this.array,c=new Uint8Array(b),d=new ArrayBuffer(a),e=new Uint8Array(d);return e.set(c),this.array=d,this.view=new DataView(d),!0}return!1},d.prototype.slice=function(a,b){if(null==this.array)throw new Error(this+" cannot be sliced: Already destroyed");if(a>=b)throw new Error(this+" cannot be sliced: End ("+b+") is less than begin ("+a+")");if(0>a||a>this.array.byteLength||1>b||b>this.array.byteLength)throw new Error(this+" cannot be sliced: Index out of bounds (0-"+this.array.byteLength+" -> "+a+"-"+b+")");var c=this.clone();return c.offset=a,c.length=b,c},d.prototype.sliceAndCompact=function(a,b){return d.wrap(this.slice(a,b).toArrayBuffer(!0))},d.prototype.ensureCapacity=function(a){return null==this.array?this.resize(a):this.array.byteLength<a?this.resize(2*this.array.byteLength>=a?2*this.array.byteLength:a):!1},d.prototype.flip=function(){return this.length=null==this.array?0:this.offset,this.offset=0,this},d.prototype.mark=function(a){if(null==this.array)throw new Error(this+" cannot be marked: Already destroyed");if(a="undefined"!=typeof a?parseInt(a,10):this.offset,0>a||a>this.array.byteLength)throw new Error(this+" cannot be marked: Offset to mark is less than 0 or bigger than the capacity ("+this.array.byteLength+"): "+a);return this.markedOffset=a,this},d.prototype.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):(this.offset=0,this.length=0),this},d.prototype.clone=function(){var a=new d(-1,this.littleEndian,!0);return a.array=this.array,a.view=this.view,a.offset=this.offset,a.length=this.length,a},d.prototype.copy=function(){if(null==this.array)return this.clone();var a=new d(this.array.byteLength,this.littleEndian),b=new Uint8Array(this.array),c=new Uint8Array(a.array);return c.set(b),a.offset=this.offset,a.length=this.length,a},d.prototype.remaining=function(){return null==this.array?0:this.length-this.offset},d.prototype.capacity=function(){return null!=this.array?this.array.byteLength:0},d.prototype.compact=function(){if(null==this.array)throw new Error(this+" cannot be compacted: Already destroyed");if(this.offset>this.length&&this.flip(),this.offset==this.length)throw new Error(this+" cannot be compacted: Offset ("+this.offset+") is equal to its length ("+this.length+")");if(0==this.offset&&this.length==this.array.byteLength)return this;var a=new Uint8Array(this.array),b=new ArrayBuffer(this.length-this.offset),c=new Uint8Array(b);return c.set(a.subarray(this.offset,this.length)),this.array=b,this.offset=0,this.length=this.array.byteLength,this},d.prototype.destroy=function(){return null!=this.array?(this.array=null,this.view=null,this.offset=0,this.length=0,this):void 0},d.prototype.reverse=function(){if(null==this.array)throw new Error(this+" cannot be reversed: Already destroyed");Array.prototype.reverse.call(new Uint8Array(this.array));var a=this.offset;return this.offset=this.array.byteLength-this.length,this.length=this.array.byteLength-a,this},d.prototype.append=function(a,b){if(a instanceof d||(a=d.wrap(a)),null==a.array)throw new Error(a+" cannot be appended to "+this+": Already destroyed");var c=a.length-a.offset;if(0==c)return this;0>c&&(a=a.clone().flip(),c=a.length-a.offset),b="undefined"!=typeof b?b:(this.offset+=c)-c,this.ensureCapacity(b+c);var e=new Uint8Array(a.array),f=new Uint8Array(this.array);return f.set(e.subarray(a.offset,a.length),b),this},d.prototype.prepend=function(a,b){if(a instanceof d||(a=d.wrap(a)),null==a.array)throw a+" cannot be prepended to "+this+": Already destroyed";var c=a.length-a.offset;if(0==c)return this;0>c&&(a=a.clone().flip(),c=a.length-a.offset);var e="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;var f=c-b;return f>0?(this.ensureCapacity(this.length+f),this.append(this,c),this.offset+=f,this.length+=f,this.append(a,0)):this.append(a,b-c),e&&(this.offset-=c),this},d.prototype.writeInt8=function(a,b){return b="undefined"!=typeof b?b:(this.offset+=1)-1,this.ensureCapacity(b+1),this.view.setInt8(b,a),this},d.prototype.readInt8=function(a){if(a="undefined"!=typeof a?a:(this.offset+=1)-1,a>=this.array.byteLength)throw new Error("Cannot read int8 from "+this+" at "+a+": Capacity overflow");return this.view.getInt8(a)},d.prototype.writeByte=d.prototype.writeInt8,d.prototype.readByte=d.prototype.readInt8,d.prototype.writeUint8=function(a,b){return b="undefined"!=typeof b?b:(this.offset+=1)-1,this.ensureCapacity(b+1),this.view.setUint8(b,a),this},d.prototype.readUint8=function(a){if(a="undefined"!=typeof a?a:(this.offset+=1)-1,a+1>this.array.byteLength)throw"Cannot read uint8 from "+this+" at "+a+": Capacity overflow";return this.view.getUint8(a)},d.prototype.writeInt16=function(a,b){return b="undefined"!=typeof b?b:(this.offset+=2)-2,this.ensureCapacity(b+2),this.view.setInt16(b,a,this.littleEndian),this},d.prototype.readInt16=function(a){if(a="undefined"!=typeof a?a:(this.offset+=2)-2,a+2>this.array.byteLength)throw new Error("Cannot read int16 from "+this+" at "+a+": Capacity overflow");return this.view.getInt16(a,this.littleEndian)},d.prototype.writeShort=d.prototype.writeInt16,d.prototype.readShort=d.prototype.readInt16,d.prototype.writeUint16=function(a,b){return b="undefined"!=typeof b?b:(this.offset+=2)-2,this.ensureCapacity(b+2),this.view.setUint16(b,a,this.littleEndian),this},d.prototype.readUint16=function(a){if(a="undefined"!=typeof a?a:(this.offset+=2)-2,a+2>this.array.byteLEngth)throw new Error("Cannot read int16 from "+this+" at "+a+": Capacity overflow");return this.view.getUint16(a,this.littleEndian)},d.prototype.writeInt32=function(a,b){return b="undefined"!=typeof b?b:(this.offset+=4)-4,this.ensureCapacity(b+4),this.view.setInt32(b,a,this.littleEndian),this},d.prototype.readInt32=function(a){if(a="undefined"!=typeof a?a:(this.offset+=4)-4,a+4>this.array.byteLength)throw new Error("Cannot read int32 from "+this+" at "+a+": Capacity overflow");return this.view.getInt32(a,this.littleEndian)},d.prototype.writeInt=d.prototype.writeInt32,d.prototype.readInt=d.prototype.readInt32,d.prototype.writeUint32=function(a,b){return b="undefined"!=typeof b?b:(this.offset+=4)-4,this.ensureCapacity(b+4),this.view.setUint32(b,a,this.littleEndian),this},d.prototype.readUint32=function(a){if(a="undefined"!=typeof a?a:(this.offset+=4)-4,a+4>this.array.byteLength)throw new Error("Cannot read uint32 from "+this+" at "+a+": Capacity overflow");return this.view.getUint32(a,this.littleEndian)},d.prototype.writeFloat32=function(a,b){return b="undefined"!=typeof b?b:(this.offset+=4)-4,this.ensureCapacity(b+4),this.view.setFloat32(b,a,this.littleEndian),this},d.prototype.readFloat32=function(a){if(a="undefined"!=typeof a?a:(this.offset+=4)-4,null==this.array||a+4>this.array.byteLength)throw new Error("Cannot read float32 from "+this+" at "+a+": Capacity overflow");return this.view.getFloat32(a,this.littleEndian)},d.prototype.writeFloat=d.prototype.writeFloat32,d.prototype.readFloat=d.prototype.readFloat32,d.prototype.writeFloat64=function(a,b){return b="undefined"!=typeof b?b:(this.offset+=8)-8,this.ensureCapacity(b+8),this.view.setFloat64(b,a,this.littleEndian),this},d.prototype.readFloat64=function(a){if(a="undefined"!=typeof a?a:(this.offset+=8)-8,null==this.array||a+8>this.array.byteLength)throw new Error("Cannot read float64 from "+this+" at "+a+": Capacity overflow");return this.view.getFloat64(a,this.littleEndian)},d.prototype.writeDouble=d.prototype.writeFloat64,d.prototype.readDouble=d.prototype.readFloat64,d.prototype.writeInt64=function(b,c){if(!a)throw new Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details");return c="undefined"!=typeof c?c:(this.offset+=8)-8,"object"==typeof b&&b instanceof a||(b=a.fromNumber(b,!1)),this.ensureCapacity(c+8),this.littleEndian?(this.view.setInt32(c,b.getLowBits(),!0),this.view.setInt32(c+4,b.getHighBits(),!0)):(this.view.setInt32(c,b.getHighBits(),!1),this.view.setInt32(c+4,b.getLowBits(),!1)),this},d.prototype.readInt64=function(b){if(!a)throw new Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details");if(b="undefined"!=typeof b?b:(this.offset+=8)-8,null==this.array||b+8>this.array.byteLength)throw this.offset-=8,new Error("Cannot read int64 from "+this+" at "+b+": Capacity overflow");var c;return c=this.littleEndian?a.fromBits(this.view.getInt32(b,!0),this.view.getInt32(b+4,!0),!1):a.fromBits(this.view.getInt32(b+4,!1),this.view.getInt32(b,!1),!1)},d.prototype.writeUint64=function(b,c){if(!a)throw new Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details");return c="undefined"!=typeof c?c:(this.offset+=8)-8,"object"==typeof b&&b instanceof a||(b=a.fromNumber(b,!0)),this.ensureCapacity(c+8),this.littleEndian?(this.view.setUint32(c,b.getLowBitsUnsigned(),!0),this.view.setUint32(c+4,b.getHighBitsUnsigned(),!0)):(this.view.setUint32(c,b.getHighBitsUnsigned(),!1),this.view.setUint32(c+4,b.getLowBitsUnsigned(),!1)),this},d.prototype.readUint64=function(b){if(!a)throw new Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details");if(b="undefined"!=typeof b?b:(this.offset+=8)-8,null==this.array||b+8>this.array.byteLength)throw this.offset-=8,new Error("Cannot read int64 from "+this+" at "+b+": Capacity overflow");var c;return c=this.littleEndian?a.fromBits(this.view.getUint32(b,!0),this.view.getUint32(b+4,!0),!0):a.fromBits(this.view.getUint32(b+4,!1),this.view.getUint32(b,!1),!0)},d.prototype.writeLong=d.prototype.writeInt64,d.prototype.readLong=d.prototype.readInt64,d.MAX_VARINT32_BYTES=5,d.prototype.writeVarint32=function(a,b){var c="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset,a>>>=0,this.ensureCapacity(b+d.calculateVarint32(a));var e=new DataView(this.array),f=0;return e.setUint8(b,128|a),a>=128?(e.setUint8(b+1,a>>7|128),a>=16384?(e.setUint8(b+2,a>>14|128),a>=1<<21?(e.setUint8(b+3,a>>21|128),a>=1<<28?(e.setUint8(b+4,a>>28&127),f=5):(e.setUint8(b+3,127&e.getUint8(b+3)),f=4)):(e.setUint8(b+2,127&e.getUint8(b+2)),f=3)):(e.setUint8(b+1,127&e.getUint8(b+1)),f=2)):(e.setUint8(b,127&e.getUint8(b)),f=1),c?(this.offset+=f,this):f},d.prototype.readVarint32=function(a){var b="undefined"==typeof a;a="undefined"!=typeof a?a:this.offset;var c,d=new DataView(this.array),e=0,f=0;do c=d.getUint8(a+e),f|=(127&c)<<7*e>>>0,++e;while(128&c);return f=0|f,b?(this.offset+=e,f):{value:f,length:e}},d.prototype.writeZigZagVarint32=function(a,b){return this.writeVarint32(d.zigZagEncode32(a),b)},d.prototype.readZigZagVarint32=function(a){var b=this.readVarint32(a);return"object"==typeof b?(b.value=d.zigZagDecode32(b.value),b):d.zigZagDecode32(b)},d.MAX_VARINT64_BYTES=10;var e=128,f=16384,g=2097152,h=268435456;return d.prototype.writeVarint64=function(b,c){if(!a)throw new Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details");var e="undefined"==typeof c;c="undefined"!=typeof c?c:this.offset,"object"==typeof b&&b instanceof a||(b=a.fromNumber(b,!1));var f=b.toInt()>>>0,g=b.shiftRightUnsigned(28).toInt()>>>0,h=b.shiftRightUnsigned(56).toInt()>>>0,i=d.calculateVarint64(b);this.ensureCapacity(c+i);var j=new DataView(this.array);switch(i){case 10:j.setUint8(c+9,h>>>7|128);case 9:j.setUint8(c+8,128|h);case 8:j.setUint8(c+7,g>>>21|128);case 7:j.setUint8(c+6,g>>>14|128);case 6:j.setUint8(c+5,g>>>7|128);case 5:j.setUint8(c+4,128|g);case 4:j.setUint8(c+3,f>>>21|128);case 3:j.setUint8(c+2,f>>>14|128);case 2:j.setUint8(c+1,f>>>7|128);case 1:j.setUint8(c+0,128|f)}return j.setUint8(c+i-1,127&j.getUint8(c+i-1)),e?(this.offset+=i,this):i},d.prototype.readVarint64=function(b){if(!a)throw new Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details");var c="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;var d,e,f=b,g=new DataView(this.array),h=0,i=0;if(e=g.getUint8(b++),d=127&e,128&e&&(e=g.getUint8(b++),d|=(127&e)<<7,128&e&&(e=g.getUint8(b++),d|=(127&e)<<14,128&e&&(e=g.getUint8(b++),d|=(127&e)<<21,128&e&&(e=g.getUint8(b++),h=127&e,128&e&&(e=g.getUint8(b++),h|=(127&e)<<7,128&e&&(e=g.getUint8(b++),h|=(127&e)<<14,128&e&&(e=g.getUint8(b++),h|=(127&e)<<21,128&e&&(e=g.getUint8(b++),i=127&e,128&e&&(e=g.getUint8(b++),i|=(127&e)<<7,128&e))))))))))throw new Error("Data must be corrupt: Buffer overrun");var j=a.from28Bits(d,h,i,!1);return c?(this.offset=b,j):{value:j,length:b-f}},d.prototype.writeZigZagVarint64=function(a,b){return this.writeVarint64(d.zigZagEncode64(a),b)},d.prototype.readZigZagVarint64=function(b){var c=this.readVarint64(b);return"object"!=typeof c||c instanceof a?d.zigZagDecode64(c):(c.value=d.zigZagDecode64(c.value),c)},d.prototype.writeVarint=d.prototype.writeVarint32,d.prototype.readVarint=d.prototype.readVarint32,d.prototype.writeZigZagVarint=d.prototype.writeZigZagVarint32,d.prototype.readZigZagVarint=d.prototype.readZigZagVarint32,d.calculateVarint32=function(a){return a>>>=0,e>a?1:f>a?2:g>a?3:h>a?4:5},d.calculateVarint64=function(b){if(!a)throw new Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details");"object"==typeof b&&b instanceof a||(b=a.fromNumber(b,!1));var c=b.toInt()>>>0,d=b.shiftRightUnsigned(28).toInt()>>>0,h=b.shiftRightUnsigned(56).toInt()>>>0;return 0==h?0==d?f>c?e>c?1:2:g>c?3:4:f>d?e>d?5:6:g>d?7:8:e>h?9:10},d.zigZagEncode32=function(a){return((a|=0)<<1^a>>31)>>>0},d.zigZagDecode32=function(a){return a>>>1^-(1&a)|0},d.zigZagEncode64=function(b){if(!a)throw new Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details");return"object"==typeof b&&b instanceof a?b.unsigned&&(b=b.toSigned()):b=a.fromNumber(b,!1),b.shiftLeft(1).xor(b.shiftRight(63)).toUnsigned()},d.zigZagDecode64=function(b){if(!a)throw new Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details");return"object"==typeof b&&b instanceof a?b.unsigned||(b=b.toUnsigned()):b=a.fromNumber(b,!0),b.shiftRightUnsigned(1).xor(b.and(a.ONE).toSigned().negate()).toSigned()},d.decodeUTF8Char=function(a,b){var c,d,e,f,g,h,i=a.readUint8(b),j=b;if(0==(128&i))h=i,b+=1;else if(192==(224&i))c=a.readUint8(b+1),h=(31&i)<<6|63&c,b+=2;else if(224==(240&i))c=a.readUint8(b+1),d=a.readUint8(b+2),h=(15&i)<<12|(63&c)<<6|63&d,b+=3;else if(240==(248&i))c=a.readUint8(b+1),d=a.readUint8(b+2),e=a.readUint8(b+3),h=(7&i)<<18|(63&c)<<12|(63&d)<<6|63&e,b+=4;else if(248==(252&i))c=a.readUint8(b+1),d=a.readUint8(b+2),e=a.readUint8(b+3),f=a.readUint8(b+4),h=(3&i)<<24|(63&c)<<18|(63&d)<<12|(63&e)<<6|63&f,b+=5;else{if(252!=(254&i))throw new Error("Cannot decode UTF8 character at offset "+b+": charCode (0x"+i.toString(16)+") is invalid");c=a.readUint8(b+1),d=a.readUint8(b+2),e=a.readUint8(b+3),f=a.readUint8(b+4),g=a.readUint8(b+5),h=(1&i)<<30|(63&c)<<24|(63&d)<<18|(63&e)<<12|(63&f)<<6|63&g,b+=6}return{"char":h,length:b-j}},d.encodeUTF8Char=function(a,b,c){var d=c;if(0>a)throw new Error("Cannot encode UTF8 character: charCode ("+a+") is negative");if(128>a)b.writeUint8(127&a,c),c+=1;else if(2048>a)b.writeUint8(a>>6&31|192,c).writeUint8(63&a|128,c+1),c+=2;else if(65536>a)b.writeUint8(a>>12&15|224,c).writeUint8(a>>6&63|128,c+1).writeUint8(63&a|128,c+2),c+=3;else if(2097152>a)b.writeUint8(a>>18&7|240,c).writeUint8(a>>12&63|128,c+1).writeUint8(a>>6&63|128,c+2).writeUint8(63&a|128,c+3),c+=4;else if(67108864>a)b.writeUint8(a>>24&3|248,c).writeUint8(a>>18&63|128,c+1).writeUint8(a>>12&63|128,c+2).writeUint8(a>>6&63|128,c+3).writeUint8(63&a|128,c+4),c+=5;else{if(!(2147483648>a))throw new Error("Cannot encode UTF8 character: charCode (0x"+a.toString(16)+") is too large (>= 0x80000000)");b.writeUint8(a>>30&1|252,c).writeUint8(a>>24&63|128,c+1).writeUint8(a>>18&63|128,c+2).writeUint8(a>>12&63|128,c+3).writeUint8(a>>6&63|128,c+4).writeUint8(63&a|128,c+5),c+=6}return c-d},d.calculateUTF8Char=function(a){if(0>a)throw new Error("Cannot calculate length of UTF8 character: charCode ("+a+") is negative");if(128>a)return 1;if(2048>a)return 2;if(65536>a)return 3;if(2097152>a)return 4;if(67108864>a)return 5;if(2147483648>a)return 6;throw new Error("Cannot calculate length of UTF8 character: charCode (0x"+a.toString(16)+") is too large (>= 0x80000000)")},d.calculateUTF8String=function(a){a=""+a;for(var b=0,c=0;c<a.length;c++)b+=d.calculateUTF8Char(a.charCodeAt(c));return b},d.prototype.writeUTF8String=function(a,b){var c="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;var e,f=b,g=d.calculateUTF8String(a);for(this.ensureCapacity(b+g),e=0;e<a.length;e++)b+=d.encodeUTF8Char(a.charCodeAt(e),this,b);return c?(this.offset=b,this):b-f},d.prototype.readUTF8String=function(a,b){var c="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;for(var e,f="",g=b,h=0;a>h;h++)e=d.decodeUTF8Char(this,b),b+=e.length,f+=String.fromCharCode(e["char"]);return c?(this.offset=b,f):{string:f,length:b-g}},d.prototype.readUTF8StringBytes=function(a,b){var c="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;var e,f="",g=b;for(a=b+a;a>b;)e=d.decodeUTF8Char(this,b),b+=e.length,f+=String.fromCharCode(e["char"]);if(b!=a)throw new Error("Actual string length differs from the specified: "+((b>a?"+":"")+b-a)+" bytes");return c?(this.offset=b,f):{string:f,length:b-g}},d.prototype.writeLString=function(a,b){a=""+a;var c="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;var e=d.encodeUTF8Char(a.length,this,b);return e+=this.writeUTF8String(a,b+e),c?(this.offset+=e,this):e},d.prototype.readLString=function(a){var b="undefined"==typeof a;a="undefined"!=typeof a?a:this.offset;var c=d.decodeUTF8Char(this,a),e=this.readUTF8String(c["char"],a+c.length);return b?(this.offset+=c.length+e.length,e.string):{string:e.string,length:c.length+e.length}},d.prototype.writeVString=function(a,b){a=""+a;var c="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;var e=this.writeVarint32(d.calculateUTF8String(a),b);return e+=this.writeUTF8String(a,b+e),c?(this.offset+=e,this):e},d.prototype.readVString=function(a){var b="undefined"==typeof a;a="undefined"!=typeof a?a:this.offset;var c=this.readVarint32(a),d=this.readUTF8StringBytes(c.value,a+c.length);return b?(this.offset+=c.length+d.length,d.string):{string:d.string,length:c.length+d.length}},d.prototype.writeCString=function(a,b){a=""+a;var c="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;var d=this.writeUTF8String(a,b);return this.writeUint8(0,b+d),c?(this.offset+=d+1,this):d+1},d.prototype.readCString=function(a){var b="undefined"==typeof a;a="undefined"!=typeof a?a:this.offset;var c,e="",f=a;do c=d.decodeUTF8Char(this,a),a+=c.length,0!=c["char"]&&(e+=String.fromCharCode(c["char"]));while(0!=c["char"]);return b?(this.offset=a,e):{string:e,length:a-f}},d.prototype.writeJSON=function(a,b,c){return c="function"==typeof c?c:JSON.stringify,this.writeLString(c(a),b)},d.prototype.readJSON=function(a,b){b="function"==typeof b?b:JSON.parse;var c=this.readLString(a);return"string"==typeof c?b(c):{data:b(c.string),length:c.length}},d.prototype.printDebug=function(a){for(var b=(null!=this.array?"ByteBuffer(offset="+this.offset+",markedOffset="+this.markedOffset+",length="+this.length+",capacity="+this.array.byteLength+")":"ByteBuffer(DESTROYED)")+"\n-------------------------------------------------------------------\n",c=this.toHex(16,!0),d=this.toASCII(16,!0),e=0;e<c.length;e++)b+=c[e]+"  "+d[e]+"\n";return a===!0?b:void("function"==typeof a?a(b):console.log(b))},d.prototype.toHex=function(a,b){if(null==this.array)return"DESTROYED";b=!!b,a="undefined"!=typeof a?parseInt(a,10):16,1>a&&(a=16);var c="",d=[],e=new DataView(this.array);c+=0==this.offset&&0==this.length?"|":0==this.length?">":0==this.offset?"<":" ";for(var f=0;f<this.array.byteLength;f++){f>0&&f%a==0&&(d.push(c),c=" ");var g=e.getUint8(f);g=g.toString(16).toUpperCase(),g.length<2&&(g="0"+g),c+=g,c+=f+1==this.offset&&f+1==this.length?"|":f+1==this.offset?"<":f+1==this.length?">":" "}if(b)for(;c.length<3*a+1;)c+="   ";return d.push(c),b?d:d.join("\n")},d.prototype.toASCII=function(a,b){if(null==this.array)return"";b=!!b,a="undefined"!=typeof a?parseInt(a,10):16,1>a&&(a=16);for(var c="",d=[],e=new DataView(this.array),f=0;f<this.array.byteLength;f++){f>0&&f%a==0&&(d.push(c),c="");var g=e.getUint8(f);g=g>32&&127>g?String.fromCharCode(g):".",c+=g}return d.push(c),b?d:d.join("\n")+"\n"},d.prototype.toString=function(){return null==this.array?"ByteBuffer(DESTROYED)":"ByteBuffer(offset="+this.offset+",markedOffset="+this.markedOffset+",length="+this.length+",capacity="+this.array.byteLength+")"},d.prototype.toArrayBuffer=function(a){var b=this.clone();b.offset>b.length&&b.flip();var c=!1;return(b.offset>0||b.length<b.array.byteLength)&&(b.compact(),c=!0),a&&!c?b.copy().array:b.array},d.prototype.toBuffer=function(){if(c){var a=this.offset,b=this.length;if(a>b){var d=a;a=b,b=d}var e=new Uint8Array(this.array);return new c(e.subarray(a,b))}throw new Error("Conversion to Buffer is available under node.js only")},d.extend=function(a,b){if("string"!=typeof a||"function"!=typeof b)throw new Error("Cannot extend prototype with "+a+"="+b+" (exptected string and function)");d.prototype[a]=b},d}"undefined"!=typeof module&&module.exports?module.exports=b(require("common/byte/Long")):"undefined"!=typeof define&&define.amd?define(["common/byte/Long"],function(a){return b(a)}):(a.dcodeIO||(a.dcodeIO={}),a.dcodeIO.ByteBuffer=b(dcodeIO.Long))}(this),function(a){var b=function(a,b,c){this.low=0|a,this.high=0|b,this.unsigned=!!c},c={},d={};b.fromInt=function(a,e){if(e){if(a>>>=0,a>=0&&256>a){var f=d[a];if(f)return f}var g=new b(a,0>(0|a)?-1:0,!0);return a>=0&&256>a&&(d[a]=g),g}if(a=0|a,a>=-128&&128>a){var f=c[a];if(f)return f}var g=new b(a,0>a?-1:0,!1);return a>=-128&&128>a&&(c[a]=g),g},b.fromNumber=function(a,c){return c=!!c,isNaN(a)||!isFinite(a)?b.ZERO:!c&&-h>=a?b.MIN_SIGNED_VALUE:c&&0>=a?b.MIN_UNSIGNED_VALUE:!c&&a+1>=h?b.MAX_SIGNED_VALUE:c&&a>=g?b.MAX_UNSIGNED_VALUE:0>a?b.fromNumber(-a,!1).negate():new b(a%f|0,a/f|0,c)},b.fromBits=function(a,c,d){return new b(a,c,d)},b.from28Bits=function(a,c,d,e){return b.fromBits(a|c<<28,c>>>4|d<<24,e)},b.fromString=function(a,c,d){if(0==a.length)throw new Error("number format error: empty string");if("number"==typeof c&&(d=c,c=!1),d=d||10,2>d||d>36)throw new Error("radix out of range: "+d);if("-"==a.charAt(0))return b.fromString(a.substring(1),c,d).negate();if(a.indexOf("-")>=0)throw new Error('number format error: interior "-" character: '+a);for(var e=b.fromNumber(Math.pow(d,8)),f=b.ZERO,g=0;g<a.length;g+=8){var h=Math.min(8,a.length-g),i=parseInt(a.substring(g,g+h),d);if(8>h){var j=b.fromNumber(Math.pow(d,h));f=f.multiply(j).add(b.fromNumber(i))}else f=f.multiply(e),f=f.add(b.fromNumber(i))}return f};var e=65536,f=e*e,g=f*f,h=g/2,i=b.fromInt(1<<24);b.ZERO=b.fromInt(0),b.ONE=b.fromInt(1),b.NEG_ONE=b.fromInt(-1),b.MAX_SIGNED_VALUE=b.fromBits(-1,2147483647,!1),b.MAX_UNSIGNED_VALUE=b.fromBits(-1,-1,!0),b.MAX_VALUE=b.MAX_SIGNED_VALUE,b.MIN_SIGNED_VALUE=b.fromBits(0,-2147483648,!1),b.MIN_UNSIGNED_VALUE=b.fromBits(0,0,!0),b.MIN_VALUE=b.MIN_SIGNED_VALUE,b.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},b.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},b.prototype.toString=function(a){if(a=a||10,2>a||a>36)throw new Error("radix out of range: "+a);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(b.MIN_SIGNED_VALUE)){var c=b.fromNumber(a),d=this.div(c),e=d.multiply(c).subtract(this);return d.toString(a)+e.toInt().toString(a)}return"-"+this.negate().toString(a)}for(var f=b.fromNumber(Math.pow(a,6)),e=this,g="";;){var h=e.div(f),i=e.subtract(h.multiply(f)).toInt(),j=i.toString(a);if(e=h,e.isZero())return j+g;for(;j.length<6;)j="0"+j;g=""+j+g}},b.prototype.getHighBits=function(){return this.high},b.prototype.getHighBitsUnsigned=function(){return this.high>>>0},b.prototype.getLowBits=function(){return this.low},b.prototype.getLowBitsUnsigned=function(){return this.low>>>0},b.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(b.MIN_SIGNED_VALUE)?64:this.negate().getNumBitsAbs();for(var a=0!=this.high?this.high:this.low,c=31;c>0&&0==(a&1<<c);c--);return 0!=this.high?c+33:c+1},b.prototype.isZero=function(){return 0==this.high&&0==this.low},b.prototype.isNegative=function(){return!this.unsigned&&this.high<0},b.prototype.isOdd=function(){return 1==(1&this.low)},b.prototype.isEven=function(){return 0==(1&this.low)},b.prototype.equals=function(a){return this.unsigned!=a.unsigned&&this.high>>>31!=a.high>>>31?!1:this.high==a.high&&this.low==a.low},b.prototype.notEquals=function(a){return!this.equals(a)},b.prototype.lessThan=function(a){return this.compare(a)<0},b.prototype.lessThanOrEqual=function(a){return this.compare(a)<=0},b.prototype.greaterThan=function(a){return this.compare(a)>0},b.prototype.greaterThanOrEqual=function(a){return this.compare(a)>=0},b.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.unsigned?a.high>>>0>this.high>>>0||a.high==this.high&&a.low>>>0>this.low>>>0?-1:1:this.subtract(a).isNegative()?-1:1},b.prototype.negate=function(){return!this.unsigned&&this.equals(b.MIN_SIGNED_VALUE)?b.MIN_SIGNED_VALUE:this.not().add(b.ONE)},b.prototype.add=function(a){var c=this.high>>>16,d=65535&this.high,e=this.low>>>16,f=65535&this.low,g=a.high>>>16,h=65535&a.high,i=a.low>>>16,j=65535&a.low,k=0,l=0,m=0,n=0;return n+=f+j,m+=n>>>16,n&=65535,m+=e+i,l+=m>>>16,m&=65535,l+=d+h,k+=l>>>16,l&=65535,k+=c+g,k&=65535,b.fromBits(m<<16|n,k<<16|l,this.unsigned)},b.prototype.subtract=function(a){return this.add(a.negate())},b.prototype.multiply=function(a){if(this.isZero())return b.ZERO;if(a.isZero())return b.ZERO;if(this.equals(b.MIN_VALUE))return a.isOdd()?b.MIN_VALUE:b.ZERO;if(a.equals(b.MIN_VALUE))return this.isOdd()?b.MIN_VALUE:b.ZERO;if(this.isNegative())return a.isNegative()?this.negate().multiply(a.negate()):this.negate().multiply(a).negate();if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(i)&&a.lessThan(i))return b.fromNumber(this.toNumber()*a.toNumber(),this.unsigned);var c=this.high>>>16,d=65535&this.high,e=this.low>>>16,f=65535&this.low,g=a.high>>>16,h=65535&a.high,j=a.low>>>16,k=65535&a.low,l=0,m=0,n=0,o=0;return o+=f*k,n+=o>>>16,o&=65535,n+=e*k,m+=n>>>16,n&=65535,n+=f*j,m+=n>>>16,n&=65535,m+=d*k,l+=m>>>16,m&=65535,m+=e*j,l+=m>>>16,m&=65535,m+=f*h,l+=m>>>16,m&=65535,l+=c*k+d*j+e*h+f*g,l&=65535,b.fromBits(n<<16|o,l<<16|m,this.unsigned)},b.prototype.div=function(a){if(a.isZero())throw new Error("division by zero");if(this.isZero())return b.ZERO;if(this.equals(b.MIN_SIGNED_VALUE)){if(a.equals(b.ONE)||a.equals(b.NEG_ONE))return min;if(a.equals(b.MIN_VALUE))return b.ONE;var c=this.shiftRight(1),d=c.div(a).shiftLeft(1);if(d.equals(b.ZERO))return a.isNegative()?b.ONE:b.NEG_ONE;var e=this.subtract(a.multiply(d)),f=d.add(e.div(a));return f}if(a.equals(b.MIN_VALUE))return b.ZERO;if(this.isNegative())return a.isNegative()?this.negate().div(a.negate()):this.negate().div(a).negate();if(a.isNegative())return this.div(a.negate()).negate();for(var g=b.ZERO,e=this;e.greaterThanOrEqual(a);){for(var d=Math.max(1,Math.floor(e.toNumber()/a.toNumber())),h=Math.ceil(Math.log(d)/Math.LN2),i=48>=h?1:Math.pow(2,h-48),j=b.fromNumber(d,this.unsigned),k=j.multiply(a);k.isNegative()||k.greaterThan(e);)d-=i,j=b.fromNumber(d,this.unsigned),k=j.multiply(a);j.isZero()&&(j=b.ONE),g=g.add(j),e=e.subtract(k)}return g},b.prototype.modulo=function(a){return this.subtract(this.div(a).multiply(a))},b.prototype.not=function(){return b.fromBits(~this.low,~this.high,this.unsigned)},b.prototype.and=function(a){return b.fromBits(this.low&a.low,this.high&a.high,this.unsigned)},b.prototype.or=function(a){return b.fromBits(this.low|a.low,this.high|a.high,this.unsigned)},b.prototype.xor=function(a){return b.fromBits(this.low^a.low,this.high^a.high,this.unsigned)},b.prototype.shiftLeft=function(a){if(a&=63,0==a)return this;var c=this.low;if(32>a){var d=this.high;return b.fromBits(c<<a,d<<a|c>>>32-a,this.unsigned)}return b.fromBits(0,c<<a-32,this.unsigned)},b.prototype.shiftRight=function(a){if(a&=63,0==a)return this;var c=this.high;if(32>a){var d=this.low;return b.fromBits(d>>>a|c<<32-a,c>>a,this.unsigned)}return b.fromBits(c>>a-32,c>=0?0:-1,this.unsigned)},b.prototype.shiftRightUnsigned=function(a){if(a&=63,0==a)return this;var c=this.high;if(32>a){var d=this.low;return b.fromBits(d>>>a|c<<32-a,c>>>a,this.unsigned)}return 32==a?b.fromBits(c,0,this.unsigned):b.fromBits(c>>>a-32,0,this.unsigned)},b.prototype.toSigned=function(){var a=this.clone();return a.unsigned=!1,a},b.prototype.toUnsigned=function(){var a=this.clone();return a.unsigned=!0,a},b.prototype.clone=function(){return new b(this.low,this.high,this.unsigned)},"undefined"!=typeof module&&module.exports?module.exports=b:"undefined"!=typeof define&&define.amd?define([],function(){return b}):(a.dcodeIO||(a.dcodeIO={}),a.dcodeIO.Long=b)}(this),function(a){function b(a){var b=function(){};return a(b,Array),b.prototype.get=function(a){return this[a]},b.prototype.size=function(){return this.length},b.prototype.add=function(){if(1==arguments.length)return void this.push(arguments[0]);if(2==arguments.length){var a=arguments[0],b=arguments[1];if("number"==typeof a)return void this.splice(a,0,b);throw"Error: ArrayList: invalid parameters"}throw"Error: ArrayList: invalid parameters"},b.prototype.remove=function(){var a=null;if(1==arguments.length){var b=this.splice(arguments[0],1);null!=b&&(a=b[0])}else if(2==arguments.length){var b=this.splice(arguments[0],arguments[1]);null!=b&&(a=lb.ArrayList.copy(b))}return a},b.prototype.clear=function(){var a=this.length;a>0&&this.splice(0)},b.prototype.copy=function(){for(var a=new lb.ArrayList,b=0;b<this.length;b++)a.add(this[b]);return a},b.prototype.append=function(a){for(var b=0;b<a.length;b++)this.add(a[b])},b.copy=function(a){if(null==a)return null;for(var b=new lb.ArrayList,c=0;c<a.length;c++)b.add(a[c]);return b},b}"undefined"!=typeof module&&module.exports?module.exports=b(require("./inherits")):"undefined"!=typeof define&&define.amd?define(["./inherits"],b):a.ArrayList=b(a.inherits)}(this),function(a){function b(){var a={};return a.assert=function(a,b){if(!a){if(b=b||"Assertion failed","undefined"!=typeof Error)throw new Error(b);throw b}},a}"undefined"!=typeof module&&module.exports?module.exports=b():"undefined"!=typeof define&&define.amd?define(b):a.Core=b()}(this),function(a){function b(){var a=function(a,b){
function c(){}c.prototype=b.prototype,a.superClass_=b.prototype,a.prototype=new c,a.prototype.constructor=a};return a}"undefined"!=typeof module&&module.exports?module.exports=b():"undefined"!=typeof define&&define.amd?define(b):a.inherits=b()}(this),function(a){function b(a){var b=function(){this._listeners=new a};return b.prototype={constructor:b,registerListener:function(a,b){if(null==a)return void console.log("Error: registerListener selector invalid");var c=this._findListener(a,b);0>c?this._listeners.add({selector:a,target:b}):console.log("Warning: already register.")},unregisterListener:function(a,b){var c=this._findListener(a,b);c>=0&&this._listeners.remove(c)},publishEvent:function(a,b){for(var c=0;c<this._listeners.length;c++)this._listeners[c].target?this._listeners[c].selector.call(this._listeners[c].target,a,b):this._listeners[c].selector(a,b)},_findListener:function(a,b){for(var c=-1,d=0;d<this._listeners.length;d++)if(this._listeners[d].target===b&&this._listeners[d].selector===a){c=d;break}return c}},b}"undefined"!=typeof module&&module.exports?module.exports=b(require("common/core/ArrayList")):"undefined"!=typeof define&&define.amd?define(["common/core/ArrayList"],b):a.EventPublisher=b(a.ArrayList)}(this),function(a){function b(){var a={};return a.getJSONP=function(a,b,c,d){var e="cb"+this.getJSONP.counter++,f="LBHttpUtil.getJSONP."+e;d=d?d:"jsonp",a+=-1===a.indexOf("?")?"?"+d+"="+f:"&"+d+"="+f;var g=document.createElement("script"),h=this,i=setTimeout(function(){delete h.getJSONP[e],g.parentNode.removeChild(g),c()},15e3);this.getJSONP[e]=function(a){try{clearTimeout(i),b(a)}finally{delete h.getJSONP[e],g.parentNode.removeChild(g)}};try{g.src=a,document.head.appendChild(g)}catch(j){c(j)}},a.getJSONP.counter=0,window.LBHttpUtil=a,a}"undefined"!=typeof module&&module.exports?module.exports=b():"undefined"!=typeof define&&define.amd?define(b):a.LBHttpUtil=b()}(this),function(a){function b(a,b,c,d){var e={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},f={SUCCESS:1e3,CONNECT_TIMEOUT:3e3},g=1e4,h=function(){h.superClass_.constructor.call(this),this.socketState=e.CLOSED,this.socketCode=f.SUCCESS,this.socket=null,this._messageTarget=null,this._messageSelector=null,this._connectTimeoutId=null,this._listener=new a};return c(h,d),h.SocketState=e,h.SocketCode=f,h.prototype.getSocketState=function(){return this.socketState},h.prototype.getSocketCode=function(){return this.socketCode},h.prototype.setOnMessage=function(a,b){this._messageTarget=b,this._messageSelector=a},h.prototype.connect=function(a){if(console.log("connect"),this.getSocketState()!=e.CLOSED)return void console.log("Connect Error: The previous socket state is unclosed.");this.socketState=e.CONNECTING;var c=this;return this.socket=new WebSocket(a),this.socket.binaryType="arraybuffer",console.log("New web socket"),this.socket.onopen=function(a){console.log("Web socket onopen"),c.socketState=e.OPEN,c.clearConnectTimeout(),c.publishEvent(c,e.OPEN)},this.socket.onclose=function(a){console.log("Web socket onclose"),c.clearConnectTimeout(),c.socketState=e.CLOSED,c.socket,c.socket=null,c.publishEvent(c,e.CLOSED)},this.socket.onmessage=function(a){try{c._messageTarget?c._messageSelector.call(c._messageTarget,a.data):c._messageSelector(a.data)}catch(b){console.log("Web socket error: "+b)}},this.socket.onerror=function(a){console.log("socket error")},this._connectTimeoutId=b.setTimeout(function(){c.connectTimeout()},g),this.socketCode=f.SUCCESS,this.publishEvent(this,e.CONNECTING),!0},h.prototype.connectTimeout=function(){console.log("connect timeout"),this.close(f.CONNECT_TIMEOUT)},h.prototype.clearConnectTimeout=function(){this._connectTimeoutId&&(b.clearTimeout(this._connectTimeoutId),this._connectTimeoutId=null)},h.prototype.send=function(a){console.log("web socket send");var b=this.getSocketState();return e.CLOSED==b?(console.log("Web socket send error: The socket is CLOSED"),!1):e.OPEN!=b?(console.log("Web socket send error: state is NOT OPEN: "+b),!1):(this.socket.send(a),!0)},h.prototype.close=function(a){return console.log("Web socket close"),e.CLOSED==this.getSocketState()?void console.log("Web socket is already closed"):void(this.socket?(console.log("close the socket"),a=a||f.SUCCESS,this.socketCode=a,this.socket.close(a,"close by client")):console.log("Warning: Web socket close: socket is null"))},h}"undefined"!=typeof module&&module.exports?module.exports=b(require("common/core/ArrayList"),require("common/util/TimerUtil"),require("common/core/inherits"),require("common/event/EventPublisher")):"undefined"!=typeof define&&define.amd?define(["common/core/ArrayList","common/util/TimerUtil","common/core/inherits","common/event/EventPublisher"],b):a.WSocket=b(a.ArrayList,a.TimerUtil,a.inherits,a.EventPublisher)}(this),function(global){"use strict";function loadProtoBuf(ByteBuffer){if(!ByteBuffer||!ByteBuffer.zigZagEncode32)throw new Error("ProtoBuf.js requires ByteBuffer.js >=1.1.0: Get it at https://github.com/dcodeIO/ByteBuffer.js");var ProtoBuf={};return ProtoBuf.VERSION="1.1.4",ProtoBuf.WIRE_TYPES={},ProtoBuf.WIRE_TYPES.VARINT=0,ProtoBuf.WIRE_TYPES.BITS64=1,ProtoBuf.WIRE_TYPES.LDELIM=2,ProtoBuf.WIRE_TYPES.STARTGROUP=3,ProtoBuf.WIRE_TYPES.ENDGROUP=4,ProtoBuf.WIRE_TYPES.BITS32=5,ProtoBuf.TYPES={int32:{name:"int32",wireType:ProtoBuf.WIRE_TYPES.VARINT},uint32:{name:"uint32",wireType:ProtoBuf.WIRE_TYPES.VARINT},sint32:{name:"sint32",wireType:ProtoBuf.WIRE_TYPES.VARINT},int64:{name:"int64",wireType:ProtoBuf.WIRE_TYPES.VARINT},uint64:{name:"uint64",wireType:ProtoBuf.WIRE_TYPES.VARINT},sint64:{name:"sint64",wireType:ProtoBuf.WIRE_TYPES.VARINT},bool:{name:"bool",wireType:ProtoBuf.WIRE_TYPES.VARINT},"double":{name:"double",wireType:ProtoBuf.WIRE_TYPES.BITS64},string:{name:"string",wireType:ProtoBuf.WIRE_TYPES.LDELIM},bytes:{name:"bytes",wireType:ProtoBuf.WIRE_TYPES.LDELIM},fixed32:{name:"fixed32",wireType:ProtoBuf.WIRE_TYPES.BITS32},sfixed32:{name:"sfixed32",wireType:ProtoBuf.WIRE_TYPES.BITS32},fixed64:{name:"fixed64",wireType:ProtoBuf.WIRE_TYPES.BITS64},sfixed64:{name:"sfixed64",wireType:ProtoBuf.WIRE_TYPES.BITS64},"float":{name:"float",wireType:ProtoBuf.WIRE_TYPES.BITS32},"enum":{name:"enum",wireType:ProtoBuf.WIRE_TYPES.VARINT},message:{name:"message",wireType:ProtoBuf.WIRE_TYPES.LDELIM}},ProtoBuf.Long=ByteBuffer.Long,ProtoBuf.Util=function(){Object.create||(Object.create=function(a){function b(){}if(arguments.length>1)throw new Error("Object.create implementation only accepts the first parameter.");return b.prototype=a,new b});var a={};return a.IS_NODE=("undefined"==typeof window||!window.window)&&"function"==typeof require,a.XHR=function(){for(var a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],b=null,c=0;c<a.length;c++){try{b=a[c]()}catch(d){continue}break}if(!b)throw new Error("XMLHttpRequest is not supported");return b},a.fetch=function(b,c){if(c&&"function"!=typeof c&&(c=null),a.IS_NODE)if(c)require("fs").readFile(b,function(a,b){c(a?null:""+b)});else try{return require("fs").readFileSync(b)}catch(d){return null}else{var e=a.XHR();if(e.open("GET",b,!!c),e.setRequestHeader("Accept","text/plain"),!c)return e.send(null),e.responseText;if(e.onreadystatechange=function(){4==e.readyState&&c(200==e.status?e.responseText:null)},4==e.readyState)return;e.send(null)}},a}(),ProtoBuf.Lang=function(){var a={OPEN:"{",CLOSE:"}",OPTOPEN:"[",OPTCLOSE:"]",OPTEND:",",EQUAL:"=",END:";",DELIM:/[\s\{\}=;\[\],"\(\)]/g,KEYWORD:/package|option|import|message|enum|extend|service|syntax|extensions/,RULE:/required|optional|repeated/,TYPE:/double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes/,NAME:/[a-zA-Z][a-zA-Z_0-9]*/,TYPEDEF:/[a-zA-Z](\.?[a-zA-Z_0-9])*/,TYPEREF:/\.?[a-zA-Z](\.?[a-zA-Z_0-9])*/,NUMBER:/^-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+|[0-9]*\.[0-9]+)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0x[0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^[0-9]*\.[0-9]+$/,ID:/^(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/"([^"\\]*(\\.[^"\\]*)*)"/g,STRINGOPEN:'"',STRINGCLOSE:'"',COPTOPEN:"(",COPTCLOSE:")"};return a}(),ProtoBuf.DotProto=function(){var a={};return a}(),ProtoBuf.DotProto.Tokenizer=function(a){var b=function(a){this.source=""+a,this.index=0,this.stack=[],this.readingString=!1};return b.prototype._readString=function(){a.STRING.lastIndex=this.index-1;var b;if(null!==(b=a.STRING.exec(this.source))){var c=b[1];return this.index=a.STRING.lastIndex,this.stack.push(a.STRINGCLOSE),c}throw new Error("Illegal string value at index "+this.index)},b.prototype.next=function(){if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(this.readingString)return this.readingString=!1,this._readString();var b;do{for(b=!1;a.WHITESPACE.test(this.source.charAt(this.index));)if(this.index++,this.index==this.source.length)return null;if("/"==this.source.charAt(this.index))if("/"==this.source.charAt(++this.index)){for(;"\n"!=this.source.charAt(this.index);)if(this.index++,this.index==this.source.length)return null;this.index++,b=!0}else{if("*"!=this.source.charAt(this.index))throw new Error("Invalid comment: /"+this.source.charAt(this.index)+" ('/' or '*' expected)");for(var c="";c+(c=this.source.charAt(this.index))!="*/";)if(this.index++,this.index==this.source.length)return null;this.index++,b=!0}}while(b);if(this.index==this.source.length)return null;var d=this.index;a.DELIM.lastIndex=0;var e=a.DELIM.test(this.source.charAt(d));if(e)d++;else for(d++;d<this.source.length&&!a.DELIM.test(this.source.charAt(d));)d++;var f=this.source.substring(this.index,this.index=d);return f==a.STRINGOPEN&&(this.readingString=!0),f},b.prototype.peek=function(){if(0==this.stack.length){var a=this.next();if(null===a)return null;this.stack.push(a)}return this.stack[0]},b.prototype.toString=function(){return"Tokenizer("+this.index+"/"+this.source.length+")"},b}(ProtoBuf.Lang),ProtoBuf.DotProto.Parser=function(a,b,c){var d=function(a){this.tn=new c(a)};return d.prototype.parse=function(){for(var a,b={name:"[ROOT]","package":null,messages:[],enums:[],imports:[],options:{}},c=!0;a=this.tn.next(),null!=a;)if("package"==a){if(!c)throw new Error("Illegal package definition: Must be declared before the first message or enum");if(null!==b["package"])throw new Error("Illegal package definition: Package already declared");b["package"]=this._parsePackage(a)}else if("import"==a){if(!c)throw new Error("Illegal import definition: Must be declared before the first message or enum");b.imports.push(this._parseImport(a))}else if("message"==a)this._parseMessage(b,a),c=!1;else if("enum"==a)this._parseEnum(b,a),c=!1;else if("option"==a){if(!c)throw new Error("Illegal option definition: Must be declared before the first message or enum");this._parseOption(b,a)}else if("extend"==a||"service"==a)this._parseIgnoredBlock(b,a);else{if("syntax"!=a)throw new Error("Illegal top level declaration: "+a);this._parseIgnoredStatement(b,a)}return delete b.name,b},d.prototype._parseNumber=function(a){var c=1;if("-"==a.charAt(0)&&(c=-1,a=a.substring(1)),b.NUMBER_DEC.test(a))return c*parseInt(a,10);if(b.NUMBER_HEX.test(a))return c*parseInt(a.substring(2),16);if(b.NUMBER_OCT.test(a))return c*parseInt(a.substring(1),8);if(b.NUMBER_FLT.test(a))return c*parseFloat(a);throw new Error("Illegal number value: "+(0>c?"-":"")+a)},d.prototype._parseId=function(a,c){var d=-1,e=1;if("-"==a.charAt(0)&&(e=-1,a=a.substring(1)),b.NUMBER_DEC.test(a))d=parseInt(a);else if(b.NUMBER_HEX.test(a))d=parseInt(a.substring(2),16);else{if(!b.NUMBER_OCT.test(a))throw new Error("Illegal ID value: "+(0>e?"-":"")+a);d=parseInt(a.substring(1),8)}if(d=e*d|0,!c&&0>d)throw new Error("Illegal ID range: "+(0>e?"-":"")+a);return d},d.prototype._parsePackage=function(a){if(a=this.tn.next(),!b.TYPEDEF.test(a))throw new Error("Illegal package name: "+a);var c=a;if(a=this.tn.next(),a!=b.END)throw new Error("Illegal end of package definition: "+a+" ('"+b.END+"' expected)");return c},d.prototype._parseImport=function(a){if(a=this.tn.next(),"public"==a&&(a=this.tn.next()),a!=b.STRINGOPEN)throw new Error("Illegal begin of import value: "+a+" ('"+b.STRINGOPEN+"' expected)");var c=this.tn.next();if(a=this.tn.next(),a!=b.STRINGCLOSE)throw new Error("Illegal end of import value: "+a+" ('"+b.STRINGCLOSE+"' expected)");if(a=this.tn.next(),a!=b.END)throw new Error("Illegal end of import definition: "+a+" ('"+b.END+"' expected)");return c},d.prototype._parseOption=function(a,c){c=this.tn.next();var d=!1;if(c==b.COPTOPEN&&(d=!0,c=this.tn.next()),!b.NAME.test(c))throw new Error("Illegal option name in message "+a.name+": "+c);var e=c;if(c=this.tn.next(),d){if(c!=b.COPTCLOSE)throw new Error("Illegal custom option name delimiter in message "+a.name+", option "+e+": "+c+" ('"+b.COPTCLOSE+"' expected)");c=this.tn.next()}if(c!=b.EQUAL)throw new Error("Illegal option operator in message "+a.name+", option "+e+": "+c+" ('"+b.EQUAL+"' expected)");var f;if(c=this.tn.next(),c==b.STRINGOPEN){if(f=this.tn.next(),c=this.tn.next(),c!=b.STRINGCLOSE)throw new Error("Illegal end of option value in message "+a.name+", option "+e+": "+c+" ('"+b.STRINGCLOSE+"' expected)")}else if(b.NUMBER.test(c))f=this._parseNumber(c,!0);else{if(!b.NAME.test(c))throw new Error("Illegal option value in message "+a.name+", option "+e+": "+c);f=c}if(c=this.tn.next(),c!=b.END)throw new Error("Illegal end of option in message "+a.name+", option "+e+": "+c+" ('"+b.END+"' expected)");a.options[e]=f},d.prototype._parseIgnoredBlock=function(a,c){var d=this.tn.next();if(!b.TYPEREF.test(d))throw new Error("Illegal "+c+" type in "+a.name+": "+d);var e=d;if(d=this.tn.next(),d!=b.OPEN)throw new Error("Illegal OPEN in "+a.name+" after "+c+" "+e+": "+d);for(var f=1;;){if(d=this.tn.next(),null===d)throw new Error("Unexpected EOF in "+a.name+", "+c+" (ignored), "+e);if(d==b.OPEN)f++;else if(d==b.CLOSE&&(d=this.tn.peek(),d==b.END&&this.tn.next(),f--,0==f))break}},d.prototype._parseIgnoredStatement=function(a,c){for(;;){var d=this.tn.next();if(null===d)throw new Error("Unexpected EOF in "+a.name+", "+c+" (ignored)");if(d==b.END)break}},d.prototype._parseMessage=function(a,c){var d={};if(c=this.tn.next(),!b.NAME.test(c))throw new Error("Illegal message name"+(a?" in message "+a.name:"")+": "+c);if(d.name=c,c=this.tn.next(),c!=b.OPEN)throw new Error("Illegal OPEN after message "+d.name+": "+c+" ('"+b.OPEN+"' expected)");for(d.fields=[],d.enums=[],d.messages=[],d.options={};;){if(c=this.tn.next(),c==b.CLOSE){c=this.tn.peek(),c==b.END&&this.tn.next();break}if(b.RULE.test(c))this._parseMessageField(d,c);else if("enum"==c)this._parseEnum(d,c);else if("message"==c)this._parseMessage(d,c);else if("option"==c)this._parseOption(d,c);else{if("extensions"!=c)throw new Error("Illegal token in message "+d.name+": "+c+" (type or '"+b.CLOSE+"' expected)");this._parseIgnoredStatement(d,c)}}return a.messages.push(d),d},d.prototype._parseMessageField=function(a,c){var d={};if(d.rule=c,c=this.tn.next(),!b.TYPE.test(c)&&!b.TYPEREF.test(c))throw new Error("Illegal field type in message "+a.name+": "+c);if(d.type=c,c=this.tn.next(),!b.NAME.test(c))throw new Error("Illegal field name in message "+a.name+": "+c);if(d.name=c,c=this.tn.next(),c!=b.EQUAL)throw new Error("Illegal field number operator in message "+a.name+"#"+d.name+": "+c+" ('"+b.EQUAL+"' expected)");c=this.tn.next();try{d.id=this._parseId(c)}catch(e){throw new Error("Illegal field id in message "+a.name+"#"+d.name+": "+c)}if(d.options={},c=this.tn.next(),c==b.OPTOPEN&&(this._parseFieldOptions(a,d,c),c=this.tn.next()),c!=b.END)throw new Error("Illegal field delimiter in message "+a.name+"#"+d.name+": "+c+" ('"+b.END+"' expected)");a.fields.push(d)},d.prototype._parseFieldOptions=function(a,c,d){for(var e=!0;d=this.tn.next(),d!=b.OPTCLOSE;){if(d==b.OPTEND){if(e)throw new Error("Illegal start of message field options in message "+a.name+"#"+c.name+": "+d);d=this.tn.next()}this._parseFieldOption(a,c,d),e=!1}},d.prototype._parseFieldOption=function(a,c,d){var e=!1;if(d==b.COPTOPEN&&(d=this.tn.next(),e=!0),!b.NAME.test(d))throw new Error("Illegal field option in message "+a.name+"#"+c.name+": "+d);var f=d;if(d=this.tn.next(),e){if(d!=b.COPTCLOSE)throw new Error("Illegal custom field option name delimiter in message "+a.name+"#"+c.name+": "+d+" (')' expected)");d=this.tn.next()}if(d!=b.EQUAL)throw new Error("Illegal field option operation in message "+a.name+"#"+c.name+": "+d+" ('=' expected)");var g;if(d=this.tn.next(),d==b.STRINGOPEN){if(g=this.tn.next(),d=this.tn.next(),d!=b.STRINGCLOSE)throw new Error("Illegal end of field value in message "+a.name+"#"+c.name+", option "+f+": "+d+" ('"+b.STRINGCLOSE+"' expected)")}else if(b.NUMBER.test(d,!0))g=this._parseNumber(d,!0);else{if(!b.TYPEREF.test(d))throw new Error("Illegal field option value in message "+a.name+"#"+c.name+", option "+f+": "+d);g=d}c.options[f]=g},d.prototype._parseEnum=function(a,c){var d={};if(c=this.tn.next(),!b.NAME.test(c))throw new Error("Illegal enum name in message "+a.name+": "+c);if(d.name=c,c=this.tn.next(),c!=b.OPEN)throw new Error("Illegal OPEN after enum "+d.name+": "+c);for(d.values=[],d.options={};;){if(c=this.tn.next(),c==b.CLOSE){c=this.tn.peek(),c==b.END&&this.tn.next();break}if("option"==c)this._parseOption(d,c);else{if(!b.NAME.test(c))throw new Error("Illegal enum value name in enum "+d.name+": "+c);this._parseEnumValue(d,c)}}a.enums.push(d)},d.prototype._parseEnumValue=function(a,c){var d={};if(d.name=c,c=this.tn.next(),c!=b.EQUAL)throw new Error("Illegal enum value operator in enum "+a.name+": "+c+" ('"+b.EQUAL+"' expected)");c=this.tn.next();try{d.id=this._parseId(c,!0)}catch(e){throw new Error("Illegal enum value id in enum "+a.name+": "+c)}if(a.values.push(d),c=this.tn.next(),c==b.OPTOPEN){var f={options:{}};this._parseFieldOptions(a,f,c),c=this.tn.next()}if(c!=b.END)throw new Error("Illegal enum value delimiter in enum "+a.name+": "+c+" ('"+b.END+"' expected)")},d.prototype.toString=function(){return"Parser"},d}(ProtoBuf,ProtoBuf.Lang,ProtoBuf.DotProto.Tokenizer),ProtoBuf.Reflect=function(ProtoBuf){var Reflect={},T=function(a,b){this.parent=a,this.name=b};T.prototype.toString=function(a){for(var b=this.name,c=this;c=c.parent,null!=c;)b=c.name+"."+b;return a&&(this instanceof Reflect.Message?b="Message "+b:this instanceof Message.Field?b="Message.Field "+b:this instanceof Enum?b="Enum "+b:this instanceof Enum.Value?b="Enum.Value "+b:this instanceof Namespace&&(b="Namespace "+b)),b},T.prototype.build=function(){throw new Error(this.toString(!0)+" cannot be built directly")},Reflect.T=T;var Namespace=function(a,b,c){T.call(this,a,b),this.children=[],this.options=c||{}};Namespace.prototype=Object.create(T.prototype),Namespace.prototype.getChildren=function(a){if(a=a||null,null==a)return this.children.slice();for(var b=[],c=0;c<this.children.length;c++)this.children[c]instanceof a&&b.push(this.children[c]);return b},Namespace.prototype.addChild=function(a){if(this.hasChild(a.name))throw new Error("Duplicate name in namespace "+this.toString(!0)+": "+a.name);this.children.push(a)},Namespace.prototype.hasChild=function(a){var b;if("number"==typeof a){for(b=0;b<this.children.length;b++)if(this.children[b]instanceof Message.Field&&this.children[b].id==a)return!0}else for(b=0;b<this.children.length;b++)if(this.children[b].name==a)return!0;return!1},Namespace.prototype.getChild=function(a){var b;if("number"==typeof a){for(b=0;b<this.children.length;b++)if(this.children[b]instanceof Message.Field&&this.children[b].id==a)return this.children[b]}else for(b=0;b<this.children.length;b++)if(this.children[b].name==a)return this.children[b];return null},Namespace.prototype.resolve=function(a){var b=a.split("."),c=this,d=0;if(""==b[d]){for(;null!=c.parent;)c=c.parent;d++}var e;do{do{if(e=c.getChild(b[d]),!(e&&e instanceof Reflect.T)){c=null;break}c=e,d++}while(d<b.length);if(null!=c)break;if(null!==this.parent)return this.parent.resolve(a)}while(null!=c);return c},Namespace.prototype.build=function(){for(var a,b={},c=this.getChildren(),d=0;d<c.length;d++)a=c[d],a instanceof Namespace&&(b[a.name]=a.build());return Object.defineProperty&&Object.defineProperty(b,"$options",{value:this.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),b},Namespace.prototype.buildOpt=function(){for(var a={},b=Object.keys(this.options),c=0;c<b.length;c++){var d=b[c],e=this.options[b[c]];a[d]=e}return a},Namespace.prototype.getOption=function(a){return"undefined"==typeof a?this.options:"undefined"!=typeof this.options[a]?this.options[a]:null},Reflect.Namespace=Namespace;var Message=function(a,b,c){Namespace.call(this,a,b,c),this.clazz=null};Message.prototype=Object.create(Namespace.prototype),Message.prototype.build=function(){for(var clazz=function(Reflect,T){var fields=T.getChildren(Reflect.Message.Field),Message=eval("0, (function "+T.name+"() { ProtoBuf.Builder.Message.call(this); this.__construct.apply(this, arguments); })");Message.prototype=Object.create(ProtoBuf.Builder.Message.prototype),Message.prototype.__construct=function(a){var b,c;for(b=0;b<fields.length;b++)c=fields[b],this[c.name]=c.repeated?[]:null;for(b=0;b<fields.length;b++)if(c=fields[b],"undefined"!=typeof c.options["default"])try{this.set(c.name,c.options["default"])}catch(d){throw new Error("[INTERNAL ERROR] "+d)}if(1!=arguments.length||"object"!=typeof a||"function"==typeof a.encode||a instanceof Array||a instanceof ByteBuffer||a instanceof ArrayBuffer||ProtoBuf.Long&&a instanceof ProtoBuf.Long)for(b=0;b<arguments.length;b++)b<fields.length&&this.set(fields[b].name,arguments[b]);else{var e=Object.keys(a);for(b=0;b<e.length;b++)this.set(e[b],a[e[b]])}},Message.prototype.add=function(a,b){var c=T.getChild(a);if(!c)throw new Error(this+"#"+a+" is undefined");if(!(c instanceof Reflect.Message.Field))throw new Error(this+"#"+a+" is not a field: "+c.toString(!0));if(!c.repeated)throw new Error(this+"#"+a+" is not a repeated field");null===this[c.name]&&(this[c.name]=[]),this[c.name].push(c.verifyValue(b,!0))},Message.prototype.set=function(a,b){var c=T.getChild(a);if(!c)throw new Error(this+"#"+a+" is not a field: undefined");if(!(c instanceof Reflect.Message.Field))throw new Error(this+"#"+a+" is not a field: "+c.toString(!0));this[c.name]=c.verifyValue(b)},Message.prototype.get=function(a){var b=T.getChild(a);if(!(b&&b instanceof Reflect.Message.Field))throw new Error(this+"#"+a+" is not a field: undefined");if(!(b instanceof Reflect.Message.Field))throw new Error(this+"#"+a+" is not a field: "+b.toString(!0));return this[b.name]};for(var i=0;i<fields.length;i++){var field=fields[i];!function(a){var b=a.name.replace(/(_[a-zA-Z])/g,function(a){return a.toUpperCase().replace("_","")});b=b.substring(0,1).toUpperCase()+b.substring(1);var c=a.name.replace(/([A-Z])/g,function(a){return"_"+a});T.hasChild("set"+b)||(Message.prototype["set"+b]=function(b){this.set(a.name,b)}),T.hasChild("set_"+c)||(Message.prototype["set_"+c]=function(b){this.set(a.name,b)}),T.hasChild("get"+b)||(Message.prototype["get"+b]=function(){return this.get(a.name)}),T.hasChild("get_"+c)||(Message.prototype["get_"+c]=function(){return this.get(a.name)})}(field)}Message.prototype.encode=function(a){a=a||new ByteBuffer;var b=a.littleEndian;try{var c=T.encode(this,a.LE()).flip();return a.littleEndian=b,c}catch(d){throw a.littleEndian=b,d}},Message.prototype.toArrayBuffer=function(){return this.encode().toArrayBuffer()},Message.prototype.toBuffer=function(){return this.encode().toBuffer()},Message.decode=function(a){a=a?a instanceof ByteBuffer?a:ByteBuffer.wrap(a):new ByteBuffer;var b=a.littleEndian;try{var c=T.decode(a.LE());return a.littleEndian=b,c}catch(d){throw a.littleEndian=b,d}},Message.prototype.toString=function(){return T.toString()};var O_o;return Object.defineProperty&&Object.defineProperty(Message,"$options",{value:T.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),Message}(Reflect,this),children=this.getChildren(),i=0;i<children.length;i++)if(children[i]instanceof Enum)clazz[children[i].name]=children[i].build();else if(children[i]instanceof Message)clazz[children[i].name]=children[i].build();else if(!(children[i]instanceof Message.Field))throw new Error("Illegal reflect child of "+this.toString(!0)+": "+children[i].toString(!0));return this.clazz=clazz},Message.prototype.encode=function(a,b){for(var c=this.getChildren(Message.Field),d=0;d<c.length;d++)c[d].encode(a.get(c[d].name),b);return b},Message.prototype.decode=function(a,b){b="number"==typeof b?b:-1;for(var c=a.offset,d=new this.clazz;a.offset<c+b||-1==b&&a.remaining()>0;){var e=a.readVarint32(),f=7&e,g=e>>3,h=this.getChild(g);if(h)h.repeated&&!h.options.packed?d.add(h.name,h.decode(f,a)):d.set(h.name,h.decode(f,a));else switch(f){case ProtoBuf.WIRE_TYPES.VARINT:a.readVarint32();break;case ProtoBuf.WIRE_TYPES.BITS32:a.offset+=4;break;case ProtoBuf.WIRE_TYPES.BITS64:a.offset+=8;break;case ProtoBuf.WIRE_TYPES.LDELIM:var i=a.readVarint32();a.offset+=i;break;default:throw new Error("Illegal wire type of unknown field "+g+" in "+this.toString(!0)+"#decode: "+f)}}for(var j=this.getChildren(Reflect.Field),k=0;k<j.length;k++)if(j[k].required&&null===d[j[k].name]){var l=new Error("Missing field "+j[k].toString(!0)+" in "+this.toString(!0)+"#decode");throw l.msg=d,l}return d},Reflect.Message=Message;var Field=function(a,b,c,d,e,f){T.call(this,a,d),this.required="required"==b,this.repeated="repeated"==b,this.type=c,this.resolvedType=null,this.id=e,this.options=f||{}};Field.prototype=Object.create(T.prototype),Field.prototype.verifyValue=function(a,b){if(b=b||!1,null===a){if(this.required)throw new Error("Illegal value for "+this.toString(!0)+": "+a+" (required)");return null}var c;if(this.repeated&&!b){a instanceof Array||(a=[a]);var d=[];for(c=0;c<a.length;c++)d.push(this.verifyValue(a[c],!0));return d}if(!this.repeated&&a instanceof Array)throw new Error("Illegal value for "+this.toString(!0)+": "+a+" (no array expected)");if(this.type==ProtoBuf.TYPES.int32||this.type==ProtoBuf.TYPES.sint32||this.type==ProtoBuf.TYPES.sfixed32)return 0|parseInt(a,10);if(this.type==ProtoBuf.TYPES.uint32||this.type==ProtoBuf.TYPES.fixed32)return parseInt(a,10)>>>0;if(ProtoBuf.Long){if(this.type==ProtoBuf.TYPES.int64||this.type==ProtoBuf.TYPES.sint64||this.type==ProtoBuf.TYPES.sfixed64)return"object"==typeof a&&a instanceof ProtoBuf.Long?a.unsigned?a.toSigned():a:ProtoBuf.Long.fromNumber(a,!1);if(this.type==ProtoBuf.TYPES.uint64||this.type==ProtoBuf.TYPES.fixed64)return"object"==typeof a&&a instanceof ProtoBuf.Long?a.unsigned?a:a.toUnsigned():ProtoBuf.Long.fromNumber(a,!0)}if(this.type==ProtoBuf.TYPES.bool)return!!a;if(this.type==ProtoBuf.TYPES["float"]||this.type==ProtoBuf.TYPES["double"])return parseFloat(a);if(this.type==ProtoBuf.TYPES.string)return""+a;if(this.type==ProtoBuf.TYPES.bytes)return"object"==typeof a&&a instanceof ByteBuffer?a:ByteBuffer.wrap(a);if(this.type==ProtoBuf.TYPES["enum"]){var e=this.resolvedType.getChildren(Enum.Value);for(c=0;c<e.length;c++){if(e[c].name==a)return e[c].id;if(e[c].id==a)return e[c].id}throw new Error("Illegal value for "+this.toString(!0)+": "+a+" (not a valid enum value)")}if(this.type==ProtoBuf.TYPES.message){if("object"!=typeof a)throw new Error("Illegal value for "+this.toString(!0)+": "+a+" (object expected)");return a instanceof this.resolvedType.clazz?a:new this.resolvedType.clazz(a)}throw new Error("[INTERNAL ERROR] Illegal value for "+this.toString(!0)+": "+a+" (undefined type "+this.type+")")},Field.prototype.encode=function(a,b){if(a=this.verifyValue(a),null==this.type||"object"!=typeof this.type)throw new Error("[INTERNAL ERROR] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===a||this.repeated&&0==a.length)return b;try{if(this.repeated){var c;if(this.options.packed){b.writeVarint32(this.id<<3|ProtoBuf.WIRE_TYPES.LDELIM),b.ensureCapacity(b.offset+=1);var d=b.offset;for(c=0;c<a.length;c++)this.encodeValue(a[c],b);var e=b.offset-d,f=ByteBuffer.calculateVarint32(e);if(f>1){var g=b.slice(d,b.offset);d+=f-1,b.offset=d,b.append(g)}b.writeVarint32(e,d-f)}else for(c=0;c<a.length;c++)b.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(a[c],b)}else b.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(a,b)}catch(h){throw new Error("Illegal value for "+this.toString(!0)+": "+a+" ("+h+")")}return b},Field.prototype.encodeValue=function(a,b){if(null!==a){if(this.type==ProtoBuf.TYPES.int32||this.type==ProtoBuf.TYPES.uint32)b.writeVarint32(a);else if(this.type==ProtoBuf.TYPES.sint32)b.writeZigZagVarint32(a);else if(this.type==ProtoBuf.TYPES.fixed32)b.writeUint32(a);else if(this.type==ProtoBuf.TYPES.sfixed32)b.writeInt32(a);else if(this.type==ProtoBuf.TYPES.int64||this.type==ProtoBuf.TYPES.uint64)b.writeVarint64(a);else if(this.type==ProtoBuf.TYPES.sint64)b.writeZigZagVarint64(a);else if(this.type==ProtoBuf.TYPES.fixed64)b.writeUint64(a);else if(this.type==ProtoBuf.TYPES.sfixed64)b.writeInt64(a);else if(this.type==ProtoBuf.TYPES.bool)b.writeVarint32(a?1:0);else if(this.type==ProtoBuf.TYPES["enum"])b.writeVarint32(a);else if(this.type==ProtoBuf.TYPES["float"])b.writeFloat32(a);else if(this.type==ProtoBuf.TYPES["double"])b.writeFloat64(a);else if(this.type==ProtoBuf.TYPES.string)b.writeVString(a);else if(this.type==ProtoBuf.TYPES.bytes)a.offset>a.length&&(b=b.clone().flip()),b.writeVarint32(a.remaining()),b.append(a);else{if(this.type!=ProtoBuf.TYPES.message)throw new Error("[INTERNAL ERROR] Illegal value to encode in "+this.toString(!0)+": "+a+" (unknown type)");var c=(new ByteBuffer).LE();this.resolvedType.encode(a,c),b.writeVarint32(c.offset),b.append(c.flip())}return b}},Field.prototype.decode=function(a,b,c){var d,e;if(a!=this.type.wireType&&(c||a!=ProtoBuf.WIRE_TYPES.LDELIM||!this.repeated))throw new Error("Illegal wire type for field "+this.toString(!0)+": "+a+" ("+this.type.wireType+" expected)");if(a==ProtoBuf.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&!c){e=b.readVarint32(),e=b.offset+e;for(var f=[];b.offset<e;)f.push(this.decode(this.type.wireType,b,!0));return f}if(this.type==ProtoBuf.TYPES.int32)return 0|b.readVarint32();if(this.type==ProtoBuf.TYPES.uint32)return b.readVarint32()>>>0;if(this.type==ProtoBuf.TYPES.sint32)return 0|b.readZigZagVarint32();if(this.type==ProtoBuf.TYPES.fixed32)return b.readUint32()>>>0;if(this.type==ProtoBuf.TYPES.sfixed32)return 0|b.readInt32();if(this.type==ProtoBuf.TYPES.int64)return b.readVarint64();if(this.type==ProtoBuf.TYPES.uint64)return b.readVarint64().toUnsigned();if(this.type==ProtoBuf.TYPES.sint64)return b.readZigZagVarint64();if(this.type==ProtoBuf.TYPES.fixed64)return b.readUint64();if(this.type==ProtoBuf.TYPES.sfixed64)return b.readInt64();if(this.type==ProtoBuf.TYPES.bool)return!!b.readVarint32();if(this.type==ProtoBuf.TYPES["enum"])return b.readVarint32();if(this.type==ProtoBuf.TYPES["float"])return b.readFloat();if(this.type==ProtoBuf.TYPES["double"])return b.readDouble();if(this.type==ProtoBuf.TYPES.string)return b.readVString();if(this.type==ProtoBuf.TYPES.bytes)return e=b.readVarint32(),d=b.clone(),d.length=d.offset+e,b.offset+=e,d;if(this.type==ProtoBuf.TYPES.message)return e=b.readVarint32(),this.resolvedType.decode(b,e);throw new Error("[INTERNAL ERROR] Illegal wire type for "+this.toString(!0)+": "+a)},Reflect.Message.Field=Field;var Enum=function(a,b,c){Namespace.call(this,a,b,c),this.object=null};Enum.prototype=Object.create(Namespace.prototype),Enum.prototype.build=function(){for(var a={},b=this.getChildren(Enum.Value),c=0;c<b.length;c++)a[b[c].name]=b[c].id;return Object.defineProperty&&Object.defineProperty(a,"$options",{value:this.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),this.object=a},Reflect.Enum=Enum;var Value=function(a,b,c){T.call(this,a,b),this.id=c};return Value.prototype=Object.create(T.prototype),Reflect.Enum.Value=Value,Reflect}(ProtoBuf),ProtoBuf.Builder=function(a,b,c){
var d=function(){this.ns=new c.Namespace(null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files=[]};return d.prototype.reset=function(){this.ptr=this.ns},d.prototype.define=function(a,d){if("string"!=typeof a||!b.TYPEDEF.test(a))throw new Error("Illegal package name: "+a);var e,f=a.split(".");for(e=0;e<f.length;e++)if(!b.NAME.test(f[e]))throw new Error("Illegal package name: "+f[e]);for(e=0;e<f.length;e++)this.ptr.hasChild(f[e])||this.ptr.addChild(new c.Namespace(this.ptr,f[e],d)),this.ptr=this.ptr.getChild(f[e]);return this},d.isValidMessage=function(a){if("string"!=typeof a.name||!b.NAME.test(a.name))return!1;if("undefined"!=typeof a.values)return!1;var c;if("undefined"!=typeof a.fields){if(!(a.fields instanceof Array))return!1;var e,f=[];for(c=0;c<a.fields.length;c++){if(!d.isValidMessageField(a.fields[c]))return!1;if(e=parseInt(a.id,10),f.indexOf(e)>=0)return!1;f.push(e)}f=null}if("undefined"!=typeof a.enums){if(!(a.enums instanceof Array))return!1;for(c=0;c<a.enums.length;c++)if(!d.isValidEnum(a.enums[c]))return!1}if("undefined"!=typeof a.messages){if(!(a.messages instanceof Array))return!1;for(c=0;c<a.messages.length;c++)if(!d.isValidMessage(a.messages[c]))return!1}return!0},d.isValidMessageField=function(a){if("string"!=typeof a.rule||"string"!=typeof a.name||"string"!=typeof a.type||"undefined"==typeof a.id)return!1;if(!(b.RULE.test(a.rule)&&b.NAME.test(a.name)&&b.TYPEREF.test(a.type)&&b.ID.test(""+a.id)))return!1;if("undefined"!=typeof a.options){if("object"!=typeof a.options)return!1;for(var c=Object.keys(a.options),d=0;d<c.length;d++)if(!b.NAME.test(c[d])||"string"!=typeof a.options[c[d]]&&"number"!=typeof a.options[c[d]])return!1}return!0},d.isValidEnum=function(a){if("string"!=typeof a.name||!b.NAME.test(a.name))return!1;if("undefined"==typeof a.values||!(a.values instanceof Array)||0==a.values.length)return!1;for(var c=0;c<a.values.length;c++){if("object"!=typeof a.values[c])return!1;if("string"!=typeof a.values[c].name||"undefined"==typeof a.values[c].id)return!1;if(!b.NAME.test(a.values[c].name)||!b.NEGID.test(""+a.values[c].id))return!1}return!0},d.prototype.create=function(a){if(a&&(a instanceof Array||(a=[a]),0!=a.length)){var e,f,g,h,i,j,k=[];for(k.push(a);k.length>0;){if(e=k.pop(),!(e instanceof Array))throw new Error("Not a valid namespace definition: "+JSON.stringify(e));for(;e.length>0;){if(f=e.shift(),d.isValidMessage(f)){if(g=new c.Message(this.ptr,f.name,f.options),f.fields&&f.fields.length>0)for(i=0;i<f.fields.length;i++){if(!d.isValidMessageField(f.fields[i]))throw new Error("Not a valid message field definition in message "+g.name+": "+JSON.stringify(f.fields[i]));if(g.hasChild(f.fields[i].id))throw new Error("Duplicate field id in message "+g.name+": "+f.fields[i].id);if(f.fields[i].options){for(h=Object.keys(f.fields[i].options),j=0;j<h.length;j++){if(!b.NAME.test(h[j]))throw new Error("Illegal field option name in message "+g.name+"#"+f.fields[i].name+": "+h[j]);if("string"!=typeof f.fields[i].options[h[j]]&&"number"!=typeof f.fields[i].options[h[j]])throw new Error("Illegal field option value in message "+g.name+"#"+f.fields[i].name+"#"+h[j]+": "+f.fields[i].options[h[j]])}h=null}g.addChild(new c.Message.Field(g,f.fields[i].rule,f.fields[i].type,f.fields[i].name,f.fields[i].id,f.fields[i].options))}if(h=[],"undefined"!=typeof f.enums&&f.enums.length>0)for(i=0;i<f.enums.length;i++)h.push(f.enums[i]);if(f.messages&&f.messages.length>0)for(i=0;i<f.messages.length;i++)h.push(f.messages[i]);if(this.ptr.addChild(g),h.length>0){k.push(e),e=h,h=null,this.ptr=g,g=null;continue}h=null,g=null}else{if(!d.isValidEnum(f))throw new Error("Not a valid message or enum definition: "+JSON.stringify(f));for(g=new c.Enum(this.ptr,f.name,f.options),i=0;i<f.values.length;i++)g.addChild(new c.Enum.Value(g,f.values[i].name,f.values[i].id));this.ptr.addChild(g),g=null}f=null}e=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this}},d.isValidImport=function(a){return!/google\/protobuf\//.test(a)},d.prototype.files=[],d.prototype["import"]=function(b,c,e){if("string"==typeof c){if(a.Util.IS_NODE){var f=require("path");c=f.resolve(c)}if(this.files[c])return this.reset(),this;this.files[c]=!0}if(b["package"]&&this.define(b["package"],b.options),b.messages&&this.create(b.messages),this.reset(),b["package"]&&this.define(b["package"],b.options),b.enums&&this.create(b.enums),this.reset(),b.imports&&b.imports.length>0){if(!c)throw new Error("Cannot determine import root: File name is unknown");for(var g=c.replace(/[\/\\][^\/\\]*$/,""),h=0;h<b.imports.length;h++){var i=g+"/"+b.imports[h];if(/\.json$/i.test(i)){var j=a.Util.fetch(i);if(null===j)throw new Error("Failed to import '"+i+"' in '"+c+"': File not found");this["import"](JSON.parse(j),i)}else{if(!d.isValidImport(i))continue;var k=null;if(k="function"==typeof e?e(i):a.Util.fetch(i),null===k)throw new Error("Failed to import '"+i+"' in '"+c+"': File not found");var l=new a.DotProto.Parser(k+"");this["import"](l.parse(),i)}}}return this},d.prototype.resolveAll=function(){if(null!=this.ptr&&"object"!=typeof this.ptr.type){if(this.ptr instanceof c.Namespace)for(var d=this.ptr.getChildren(),e=0;e<d.length;e++)this.ptr=d[e],this.resolveAll();else if(this.ptr instanceof c.Message.Field)if(b.TYPE.test(this.ptr.type))this.ptr.type=a.TYPES[this.ptr.type];else{if(!b.TYPEREF.test(this.ptr.type))throw new Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);var f=this.ptr.parent.resolve(this.ptr.type);if(!f)throw new Error("Unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=f,f instanceof c.Enum)this.ptr.type=a.TYPES["enum"];else{if(!(f instanceof c.Message))throw new Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=a.TYPES.message}}else if(!(this.ptr instanceof a.Reflect.Enum.Value))throw new Error("Illegal object type in namespace: "+typeof this.ptr+":"+this.ptr);this.reset()}},d.prototype.build=function(a){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null==this.result&&(this.result=this.ns.build()),a){for(var b=a.split("."),c=this.result,d=0;d<b.length;d++){if(!c[b[d]]){c=null;break}c=c[b[d]]}return c}return this.result},d.prototype.lookup=function(a){return a?this.ns.resolve(a):this.ns},d.prototype.toString=function(){return"Builder"},d.Message=function(){},d}(ProtoBuf,ProtoBuf.Lang,ProtoBuf.Reflect),ProtoBuf.protoFromString=function(a,b,c,d){"string"==typeof b&&(c=b,b=null);var e=new ProtoBuf.DotProto.Parser(a+""),f=e.parse(),b="object"==typeof b?b:new ProtoBuf.Builder;return null!==f["package"]&&b.define(f["package"],f.options),b.create(f.messages),b.reset(),null!==f["package"]&&b.define(f["package"],f.options),b.create(f.enums),b.reset(),c&&f.imports.length>0&&b["import"]({imports:f.imports},c,d),b.resolveAll(),b.build(),b},ProtoBuf.protoFromFile=function(a,b,c,d){if(b&&"object"==typeof b?(c=b,b=null):b&&"function"==typeof b||(b=null),!b){var e=null;return e="function"==typeof d?d(a):ProtoBuf.Util.fetch(a),null!==e?ProtoBuf.protoFromString(e,c,a,d):null}if("function"==typeof d){var e=d(a);b(ProtoBuf.protoFromString(e,c,a,d))}else ProtoBuf.Util.fetch(a,function(d){b(ProtoBuf.protoFromString(d,c,a))})},ProtoBuf.newBuilder=function(a,b){var c=new ProtoBuf.Builder;return"undefined"!=typeof a&&c.define(a,b),c},ProtoBuf}"undefined"!=typeof module&&module.exports?module.exports=loadProtoBuf(require("common/byte/ByteBuffer")):"undefined"!=typeof define&&define.amd?define(["common/byte/ByteBuffer"],loadProtoBuf):(global.dcodeIO||(global.dcodeIO={}),global.dcodeIO.ProtoBuf=loadProtoBuf(global.dcodeIO.ByteBuffer))}(this),function(a){function b(){function a(){}return a.setItem=function(a,b){if(!localStorage)return!1;try{return localStorage.setItem(a,b),!0}catch(c){console.log(c)}return!1},a.getItem=function(a){if(localStorage)try{return localStorage.getItem(a)}catch(b){console.log(b)}},a.removeItem=function(a){if(localStorage)try{localStorage.removeItem(a)}catch(b){console.log(b)}},a.clear=function(){if(!localStorage)return!1;try{localStorage.clear()}catch(a){console.log(a)}},a.setItemAsJson=function(b,c){var d=JSON.stringify(c);return a.setItem(b,d)},a.getItemAsJson=function(b){var c=a.getItem(b);if(c){var d=JSON.parse(c);return d}},a}"undefined"!=typeof module&&module.exports?module.exports=b():"undefined"!=typeof define&&define.amd?define([],b):a.Storage=b()}(this),function(a){function b(a){function b(){if(g)return h;g=!0;var a=new Uint8Array([21,31]);try{new Blob([a])}catch(b){return h=!1,!1}return h=!0,!0}function c(a,b){var c=i.width,d=i.height,e={width:a.width,height:a.height};if("5678".indexOf(b)>-1&&(e.width=a.height,e.height=a.width),e.width<c||e.height<d)return e;var f=e.width/e.height;for(c&&d?f>=c/d?e.width>c&&(e.width=c,e.height=Math.ceil(c/f)):e.height>d&&(e.height=d,e.width=Math.ceil(d*f)):c?c<e.width&&(e.width=c,e.height=Math.ceil(c/f)):d&&d<e.height&&(e.width=Math.ceil(d*f),e.height=d);e.width>=3264||e.height>=2448;)e.width*=.8,e.height*=.8;return e}function d(b,d,e){a.getData(b,function(){var f=a.getTag(b,"Orientation"),g=c(b,f);d.width=g.width,d.height=g.height;var h=d.getContext("2d");switch(f){case 3:h.rotate(180*Math.PI/180),h.drawImage(b,-g.width,-g.height,g.width,g.height);break;case 6:h.rotate(90*Math.PI/180),h.drawImage(b,0,-g.width,g.height,g.width);break;case 8:h.rotate(270*Math.PI/180),h.drawImage(b,-g.height,0,g.height,g.width);break;case 2:h.translate(g.width,0),h.scale(-1,1),h.drawImage(b,0,0,g.width,g.height);break;case 4:h.translate(g.width,0),h.scale(-1,1),h.rotate(180*Math.PI/180),h.drawImage(b,-g.width,-g.height,g.width,g.height);break;case 5:h.translate(g.width,0),h.scale(-1,1),h.rotate(90*Math.PI/180),h.drawImage(b,0,-g.width,g.height,g.width);break;case 7:h.translate(g.width,0),h.scale(-1,1),h.rotate(270*Math.PI/180),h.drawImage(b,-g.height,0,g.height,g.width);break;default:h.drawImage(b,0,0,g.width,g.height)}e()})}function e(a,b){var c=(a.width,a.height,document.createElement("canvas"));c.getContext("2d"),d(a,c,function(){for(var a=c.toDataURL(),a=c.toDataURL("image/jpeg",.2),d=a.split(",")[1],e=window.atob(d),f=new Uint8Array(e.length),g=0;g<e.length;g++)f[g]=e.charCodeAt(g);try{var h=new Blob([f],{type:"image/jpeg"})}catch(i){return void b()}b(h,"jpeg")})}var f={},g=!1,h=!1,i={width:0,height:0};return f.compress=function(a,c){if(!b())return void c();var d=new Image;d.src=a,d.onload=function(){e(d,c)}},f.sumPostFilesSize=function(a){if(a){var b=0;for(var c in a)if(a[c]){var d=a[c].data.size/1024/1e3;b+=d}return b}},f}"undefined"!=typeof module&&module.exports?module.exports=b(require("common/util/exif")):"undefined"!=typeof define&&define.amd?define(["common/util/exif"],b):a.ImageUtil=b(a.EXIF)}(this),function(a){function b(){var a={};return a.loadJs=function(a){document.write('<script language="javascript" type="text/javascript"'),document.write(' src="'+a+'">'),document.write("</script>")},a.loadAsyncJs=function(a,b,c){var d=document.createElement("script");d.type="text/javascript",d.src=a,d.async=!0,"function"==typeof b&&(d.onreadystatechange?d.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||b()}:d.onload=function(){b()}),c=c||document.getElementsByTagName("head")[0],c.appendChild(d)},a.asyncSerialLoadResources=function(a,b,c){var d,e=a.length,f=-1,g=this;(d=function(){if(f++,f>=e)b();else{var h=a[f];h?g.loadAsyncJs(h,d,c):d()}})()},a.asyncParallelLoadResources=function(a,b,c){for(var d=a.length,e=0,f=0;d>f;f++)self.loadAsyncJs(a[f],function(){++e>=d&&b()},c)},a}"undefined"!=typeof module&&module.exports?module.exports=b():"undefined"!=typeof define&&define.amd?define(b):a.LoadUtil=b()}(this),function(a){function b(){var a={};return a.random=function(){var a=2147483648*Math.random();return Math.floor(a)},a}"undefined"!=typeof module&&module.exports?module.exports=b():"undefined"!=typeof define&&define.amd?define(b):a.MathUtil=b()}(this),function(a){function b(){var a={};return a.isEndSuffix=function(a,b){if(b.length>a.length)return!1;var c=a.lastIndexOf(b);return c==a.length-b.length},a.isBeginPrefix=function(a,b){var c=a.indexOf(b);return 0==c},a.isUrl=function(b){return!(!a.isBeginPrefix(b,"http://")&&!a.isBeginPrefix(b,"https://"))},a.isRegexp=function(a){return"[object RegExp]"===Object.prototype.toString.call(a)},a.isPlainObj=function(a){var b;return"[object Object]"===toString.call(a)&&(b=Object.getPrototypeOf(a),null===b||b===Object.getPrototypeOf({}))},a.stringifyObject=function(b,c,d){var e=[];return function f(b,c,d){if(c=c||{},c.indent=c.indent||"	",d=d||"",null===b||void 0===b||"number"==typeof b||"boolean"==typeof b||"function"==typeof b||a.isRegexp(b))return String(b);if(b instanceof Date)return"new Date('"+b.toISOString()+"')";if(Array.isArray(b))return 0===b.length?"[]":"[\n"+b.map(function(a,e){var g=b.length-1===e?"\n":",\n";return d+c.indent+f(a,c,d+c.indent)+g}).join("")+d+"]";if(a.isPlainObj(b)){if(-1!==e.indexOf(b))return'"[Circular]"';var g=Object.keys(b);if(0===g.length)return"{}";e.push(b);var h="{\n"+g.map(function(a,e){if(c.filter&&!c.filter(b,a))return"";var h=g.length-1===e?"\n":",\n",i=/^[a-z$_][a-z$_0-9]*$/i.test(a)?a:f(a,c);return d+c.indent+i+": "+f(b[a],c,d+c.indent)+h}).join("")+d+"}";return e.pop(b),h}return b=String(b).replace(/[\r\n]/g,function(a){return"\n"===a?"\\n":"\\r"}),c.singleQuotes===!1?'"'+b.replace(/"/g,'\\"')+'"':"'"+b.replace(/'/g,"\\'")+"'"}(b,c,d)},a}"undefined"!=typeof module&&module.exports?module.exports=b():"undefined"!=typeof define&&define.amd?define(b):a.StringUtil=b()}(this),function(a){function b(){var a={};return a.setTimeout=function(a,b){return setTimeout(a,b)},a.clearTimeout=function(a){return clearTimeout(a)},a.setInterval=function(a,b){return setInterval(a,b)},a.clearInterval=function(a){return clearInterval(a)},a.isToday=function(a){var b=new Date,c=Date.parse(b),d=c-a;if(d=0>d?-d:d,864e5>d){var e=new Date;if(e.setTime(a),b.getDate()==e.getDate())return!0}return!1},a.judgeTime=function(a){var b=new Date,c=Date.parse(b),d=c-a;if(0>d)return 2;if(864e5>d){var e=new Date;if(e.setTime(a),b.getDate()==e.getDate())return 1}return 0},a}"undefined"!=typeof module&&module.exports?module.exports=b():"undefined"!=typeof define&&define.amd?define(b):a.TimerUtil=b()}(this),function(a){function b(){var a={};return a.queryArgs=function(a){for(var b={},c=a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("=");if(-1!=e){var f=c[d].substring(0,e),g=c[d].substring(e+1);f=decodeURIComponent(f),g=decodeURIComponent(g),b[f]=g}}return b},a.getUrlArgs=function(b){var c={};b=b||location.href;var d=b.indexOf("?");if(0>d)return c;var e=b.substring(d+1);return a.queryArgs(e)},a.getUrlArgs2=function(b){var c={};b=b||location.href;var d=b.indexOf("?");if(0>d)return c;var e,f=b.indexOf("#");return e=f>0?b.substring(d+1,f):b.substring(d+1),a.queryArgs(e)},a.getUrlArgs3=function(b){var c={};b=b||location.href;var d=b.indexOf("#");if(-1==d)return c;var e=b.substring(d+1);return a.queryArgs(e)},a.getUrlArgs4=function(b){b=b||location.href;var c={},d=b.indexOf("?");return d>-1?(b=b.replace("/#","&"),b=b.replace("#","&")):d=b.indexOf("#"),d>-1?(b=b.substring(d+1),a.queryArgs(b)):c},a.encodeArgs=function(b,c){if(!c)return b;var d={};for(var e in c)if(c.hasOwnProperty(e)&&"function"!=typeof c[e]){var f=c[e].toString();d[encodeURIComponent(e)]=encodeURIComponent(f)}return a.appendArgs(b,d)},a.appendArgs=function(a,b){if(!b)return a;var c=[];for(var d in b)if(b.hasOwnProperty(d)&&null!=b[d]&&"function"!=typeof b[d]){var e=b[d].toString();c.push(d+"="+e)}if(c.length<=0)return a;var f=c.join("&"),g=a.indexOf("?");return 0>g?a+"?"+f:g==a.length-1?a+f:a+"&"+f},a.getPath=function(){var a=location.protocol;return":"==a[a.length-1]?a+="//":"/"!=a[a.length-1]&&(a+="://"),a+location.host+location.pathname},a.modifyUrl=function(b,c,d,e){b=b||location.href;var f=b.split("?")[0],g="",h=b.indexOf("#");-1!=h&&(g=b.substring(h));var i=a.getUrlArgs2(b);if("object"==typeof c)for(var j in c)null!=c[j]&&(i[j]=c[j]);if("object"==typeof d)for(var k in d)delete i[d[k]];return e&&(i.lbPRHash=Math.random().toString(36).substr(2,8)),a.appendArgs(f,i)+g},a}"undefined"!=typeof module&&module.exports?module.exports=b():"undefined"!=typeof define&&define.amd?define(b):a.UrlUtil=b()}(this),function(a){function b(){var a={};return a.getElementRectByClassName=function(b){return a.getElementRect(document.getElementsByClassName(b)[0])},a.getElementRect=function(a){var b=a.getBoundingClientRect(),c=b.width||b.right-b.left,d=b.height||b.bottom-b.top;return{left:b.left,top:b.top,width:c,height:d}},a.getViewportSize=function(a){if(a=a||window,null!=a.innerWidth)return{w:a.innerWidth,h:a.innerHeight};var b=a.document;return"CSS1Compat"==document.compatMode?{w:b.documentElement.clientWidth,h:b.documentElement.clientHeight}:{w:b.body.clientWidth,h:b.body.clientWidth}},a.getScrollOffsets=function(a){if(a=a||window,null!=a.pageXOffset)return{x:a.pageXOffset,y:a.pageYOffset};var b=a.document;return"CSS1Compat"==document.compatMode?{x:b.documentElement.scrollLeft,y:b.documentElement.scrollTop}:{x:b.body.scrollLeft,y:b.body.scrollTop}},a}"undefined"!=typeof module&&module.exports?module.exports=b():"undefined"!=typeof define&&define.amd?define(b):a.WindowUtil=b()}(this),function(){function a(a){return!!a.exifdata}function b(a,b){b=b||a.match(/^data\:([^\;]+)\;base64,/im)[1]||"",a=a.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var c=atob(a),d=c.length,e=new ArrayBuffer(d),f=new Uint8Array(e),g=0;d>g;g++)f[g]=c.charCodeAt(g);return e}function c(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.responseType="blob",c.onload=function(a){200!=this.status&&0!==this.status||b(this.response)},c.send()}function d(a,d){function g(b){var c=e(b),g=f(b);a.exifdata=c||{},a.iptcdata=g||{},d&&d.call(a)}if(a.src)if(/^data\:/i.test(a.src)){var h=b(a.src);g(h)}else if(/^blob\:/i.test(a.src)){var i=new FileReader;i.onload=function(a){g(a.target.result)},c(a.src,function(a){i.readAsArrayBuffer(a)})}else{var j=new XMLHttpRequest;j.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";g(j.response),j=null},j.open("GET",a.src,!0),j.responseType="arraybuffer",j.send(null)}else if(window.FileReader&&(a instanceof window.Blob||a instanceof window.File)){var i=new FileReader;i.onload=function(a){l&&console.log("Got file of length "+a.target.result.byteLength),g(a.target.result)},i.readAsArrayBuffer(a)}}function e(a){var b=new DataView(a);if(l&&console.log("Got file of length "+a.byteLength),255!=b.getUint8(0)||216!=b.getUint8(1))return l&&console.log("Not a valid JPEG"),!1;for(var c,d=2,e=a.byteLength;e>d;){if(255!=b.getUint8(d))return l&&console.log("Not a valid marker at offset "+d+", found: "+b.getUint8(d)),!1;if(c=b.getUint8(d+1),l&&console.log(c),225==c)return l&&console.log("Found 0xFFE1 marker"),k(b,d+4,b.getUint16(d+2)-2);d+=2+b.getUint16(d+2)}}function f(a){var b=new DataView(a);if(l&&console.log("Got file of length "+a.byteLength),255!=b.getUint8(0)||216!=b.getUint8(1))return l&&console.log("Not a valid JPEG"),!1;for(var c=2,d=a.byteLength,e=function(a,b){return 56===a.getUint8(b)&&66===a.getUint8(b+1)&&73===a.getUint8(b+2)&&77===a.getUint8(b+3)&&4===a.getUint8(b+4)&&4===a.getUint8(b+5)};d>c;){if(e(b,c)){var f=b.getUint8(c+7);f%2!==0&&(f+=1),0===f&&(f=4);var h=c+8+f,i=b.getUint16(c+6+f);return g(a,h,i)}c++}}function g(a,b,c){for(var d,e,f,g,h,i=new DataView(a),k={},l=b;b+c>l;)28===i.getUint8(l)&&2===i.getUint8(l+1)&&(g=i.getUint8(l+2),g in t&&(f=i.getInt16(l+3),h=f+5,e=t[g],d=j(i,l+5,f),k.hasOwnProperty(e)?k[e]instanceof Array?k[e].push(d):k[e]=[k[e],d]:k[e]=d)),l++;return k}function h(a,b,c,d,e){var f,g,h,j=a.getUint16(c,!e),k={};for(h=0;j>h;h++)f=c+12*h+2,g=d[a.getUint16(f,!e)],!g&&l&&console.log("Unknown tag: "+a.getUint16(f,!e)),k[g]=i(a,f,b,c,e);return k}function i(a,b,c,d,e){var f,g,h,i,k,l,m=a.getUint16(b+2,!e),n=a.getUint32(b+4,!e),o=a.getUint32(b+8,!e)+c;switch(m){case 1:case 7:if(1==n)return a.getUint8(b+8,!e);for(f=n>4?o:b+8,g=[],i=0;n>i;i++)g[i]=a.getUint8(f+i);return g;case 2:return f=n>4?o:b+8,j(a,f,n-1);case 3:if(1==n)return a.getUint16(b+8,!e);for(f=n>2?o:b+8,g=[],i=0;n>i;i++)g[i]=a.getUint16(f+2*i,!e);return g;case 4:if(1==n)return a.getUint32(b+8,!e);for(g=[],i=0;n>i;i++)g[i]=a.getUint32(o+4*i,!e);return g;case 5:if(1==n)return k=a.getUint32(o,!e),l=a.getUint32(o+4,!e),h=new Number(k/l),h.numerator=k,h.denominator=l,h;for(g=[],i=0;n>i;i++)k=a.getUint32(o+8*i,!e),l=a.getUint32(o+4+8*i,!e),g[i]=new Number(k/l),g[i].numerator=k,g[i].denominator=l;return g;case 9:if(1==n)return a.getInt32(b+8,!e);for(g=[],i=0;n>i;i++)g[i]=a.getInt32(o+4*i,!e);return g;case 10:if(1==n)return a.getInt32(o,!e)/a.getInt32(o+4,!e);for(g=[],i=0;n>i;i++)g[i]=a.getInt32(o+8*i,!e)/a.getInt32(o+4+8*i,!e);return g}}function j(a,b,c){var d="";for(n=b;n<b+c;n++)d+=String.fromCharCode(a.getUint8(n));return d}function k(a,b){if("Exif"!=j(a,b,4))return l&&console.log("Not valid EXIF data! "+j(a,b,4)),!1;var c,d,e,f,g,i=b+6;if(18761==a.getUint16(i))c=!1;else{if(19789!=a.getUint16(i))return l&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;c=!0}if(42!=a.getUint16(i+2,!c))return l&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var k=a.getUint32(i+4,!c);if(8>k)return l&&console.log("Not valid TIFF data! (First offset less than 8)",a.getUint32(i+4,!c)),!1;if(d=h(a,i,i+k,q,c),d.ExifIFDPointer){f=h(a,i,i+d.ExifIFDPointer,p,c);for(e in f){switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":f[e]=s[e][f[e]];break;case"ExifVersion":case"FlashpixVersion":f[e]=String.fromCharCode(f[e][0],f[e][1],f[e][2],f[e][3]);break;case"ComponentsConfiguration":f[e]=s.Components[f[e][0]]+s.Components[f[e][1]]+s.Components[f[e][2]]+s.Components[f[e][3]]}d[e]=f[e]}}if(d.GPSInfoIFDPointer){g=h(a,i,i+d.GPSInfoIFDPointer,r,c);for(e in g){switch(e){case"GPSVersionID":g[e]=g[e][0]+"."+g[e][1]+"."+g[e][2]+"."+g[e][3]}d[e]=g[e]}}return d}var l=!1,m=this,o=function(a){return a instanceof o?a:this instanceof o?void(this.EXIFwrapped=a):new o(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=o),exports.EXIF=o):m.EXIF=o;var p=o.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},q=o.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},r=o.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},s=o.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},t={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};o.getData=function(b,c){return(b instanceof Image||b instanceof HTMLImageElement)&&!b.complete?!1:(a(b)?c&&c.call(b):d(b,c),!0)},o.getTag=function(b,c){return a(b)?b.exifdata[c]:void 0},o.getAllTags=function(b){if(!a(b))return{};var c,d=b.exifdata,e={};for(c in d)d.hasOwnProperty(c)&&(e[c]=d[c]);return e},o.pretty=function(b){if(!a(b))return"";var c,d=b.exifdata,e="";for(c in d)d.hasOwnProperty(c)&&(e+="object"==typeof d[c]?d[c]instanceof Number?c+" : "+d[c]+" ["+d[c].numerator+"/"+d[c].denominator+"]\r\n":c+" : ["+d[c].length+" values]\r\n":c+" : "+d[c]+"\r\n");return e},o.readFromBinaryFile=function(a){return e(a)},"undefined"!=typeof define&&define.amd&&define(function(){return o})}.call(this);